{
  "info": "success",
  "data": {
    "eachBgSlowQueryInfo": {
      "\u667a\u80fd\u652f\u4ed8": {
        "\u62db\u8d22\u732b": {
          "bscancqrcode": {
            "businessGroupName": "\u521b\u65b0\u4e1a\u52a1\u7814\u53d1\u7ec4",
            "serviceGroupOwner": "haoxuewu",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "bscancqrcode",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct(erp) from magicbox_ocr_report where utime between ? and ? order by erp limit ?",
                "queryCount": 54,
                "slowType": "0.5S",
                "dbName": "zcm_qrcode_bscanc",
                "sqlId": 65027193
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select substring(t?utime,?,?) datestr,count(?) total from magicbox_ocr_report t? left join device_version t? on t?vice_id=t?vice_id where t?utime >? and t?utime < ? and t?ur_version >=? and t?lient_type=? group by substring(t?utime,?,?)",
                "queryCount": 12,
                "slowType": "0.5S",
                "dbName": "zcm_qrcode_bscanc",
                "sqlId": 65027205
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select date_str datestr,count(case when erp !=? then ? end) erpreports,count(distinct device_id) as devicealives,count(?) moneypictures,count(case when ocr_code =? then ? end) as ocrsuccesss, count(case when is_ocr_right =? then ? end) ocrrights,count(case when is_ocr_right =? then ? end)\/count(?) as ocrrightrate from( select t?rp,t?vice_id,t?ocr_code,t?is_ocr_right,substring(t?utime,?,?) as date_str from magicbox_ocr_report t? left join device_version t? on t?vice_id=t?vice_id where t?utime >? and t?utime < ? and t?ur_version >=? and t?lient_type=? ) tt group by date_str",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcm_qrcode_bscanc",
                "sqlId": 65027242
              }
            ]
          },
          "zcmcrm": {
            "businessGroupName": "\u9500\u552e\u7ba1\u7406\u7ec4",
            "serviceGroupOwner": "muzongyan",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "zcmcrm",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct business_license_number from temp_oasis_qualification_business where char_length(business_license_number) in(?+) and id not in ( select id from temp_oasis_qualification_business where char_length(replace(old_business_license_number,?,?)) in(?+) and replace(old_business_license_number,?,?) regexp ? ) and deadline_type is ? order by id limit ?",
                "queryCount": 119,
                "slowType": "0.5S",
                "dbName": "zcm_crm_customer",
                "sqlId": 65027188
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(distinct business_license_number) from temp_oasis_qualification_business where char_length(business_license_number) in(?+) and id not in ( select id from temp_oasis_qualification_business where char_length(replace(old_business_license_number,?,?)) in(?+) and replace(old_business_license_number,?,?) regexp ? ) and deadline_type is ?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcm_crm_customer",
                "sqlId": 65027250
              }
            ]
          },
          "poscustomer": {
            "businessGroupName": "\u8425\u9500\u7ec4",
            "serviceGroupOwner": "shiwentao",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "poscustomer",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mkt_poi_operation_sum_i_d where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027372
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mkt_poi_operation_sum_i_d where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027373
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mkt_biz_operation_sum_i_d where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027376
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `poi_order_count_history` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027378
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mkt_biz_operation_sum_i_d where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027381
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mkt_ba_consume_statis_i_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027382
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mkt_biz_operation_sum_i_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027384
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mkt_poi_operation_sum_i_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027386
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from mkt_coupon_stat_member_id where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027387
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `mkt_coupon_stat_poi_id` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027389
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from poi_order_count_history_? where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027391
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `poi_order_count_history_?` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027392
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from poi_order_count_history where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027394
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from mkt_coupon_stat_poi_id where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027403
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `mkt_coupon_stat_member_id` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027404
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from poi_order_count_history_? where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "poscustomer",
                "sqlId": 65027406
              }
            ]
          },
          "poszcdatamart": {
            "businessGroupName": "\u6570\u636e\u7ec4",
            "serviceGroupOwner": "dongchao",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "poszcdatamart",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_monitor_poi_detail_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 71,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027191
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select partition_date ,case when product_type=? then ? else product_type end as product_type ,case when channel=? then ? when channel=? then ? else channel end as channel ,(case when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? end) as product_order ,(case when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? end) as channel_order ,order_cnt ,gpv ,poicnt ,purenewpoicnt ,active_poicnt ,pinrate\/? as pinrate ,avg_poi_gpv ,avg_poi_order_cnt ,orderprice ,if(order_cnt>?,card_cnt\/order_cnt,?) card_order_rate ,if(order_cnt>?,wechat_cnt\/order_cnt,?) wechat_order_rate ,if(order_cnt>?,alipay_cnt\/order_cnt,?) alipay_order_rate ,if(gpv>?,card_gpv\/gpv,?) card_gpv_rate ,if(gpv>?,wechat_gpv\/gpv,?) wechat_gpv_rate ,if(gpv>?,alipay_gpv\/gpv,?) alipay_gpv_rate ,card_cnt ,wechat_cnt ,alipay_cnt ,card_gpv ,wechat_gpv ,alipay_gpv from app_trade_core_data_channel_a_d where partition_date between ? and ? order by partition_date ,product_order ,channel_order limit ?",
                "queryCount": 36,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027196
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), concat(date_add(a.partition_date,interval ? day),?,a.partition_date))) as `\u7edf\u8ba1\u65e5\u671f` ,b.state_name `\u90e8\u95e8` ,b.district_name `\u5927\u533a` ,b.region_name `\u533a\u57df` ,b.area_name `\u5206\u533a` ,b.org_unit_name `\u57ce\u5e02` ,b.org_name `\u5c0f\u7ec4` ,concat(b.employee_name,?,b.mis_name,if(b.job_status = ?, ?, ?)) `bd` ,if(b.job_status=?,?,if(b.job_status=?,?,?)) `\u5728\u804c\u72b6\u6001` ,a.all_commit_poi_cnt `\u4e0a\u5355\u95e8\u5e97\u6570` ,a.pos_commit_poi_cnt `pos\u4e0a\u5355\u95e8\u5e97\u6570` ,a.qrc_commit_poi_cnt `\u4e8c\u7ef4\u7801\u4e0a\u5355\u95e8\u5e97\u6570` ,a.secpay_commit_poi_cnt `\u79d2\u4ed8\u4e0a\u5355\u95e8\u5e97\u6570` ,a.paybox_commit_poi_cnt `\u5c0f\u767d\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,a.blackbox_commit_poi_cnt `\u5c0f\u9ed1\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,a.all_bind_poi_cnt `\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.pos_bind_poi_cnt `pos\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.qrc_bind_poi_cnt `\u4e8c\u7ef4\u7801\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.secpay_bind_poi_cnt `\u79d2\u4ed8\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.paybox_bind_poi_cnt `\u5c0f\u767d\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.blackbox_bind_poi_cnt `\u5c0f\u9ed1\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,a.all_new_poi_cnt `\u65b0\u589e\u95e8\u5e97\u6570` ,a.pos_new_poi_cnt `pos\u65b0\u589e\u95e8\u5e97\u6570` ,a.qrc_new_poi_cnt `\u4e8c\u7ef4\u7801\u65b0\u589e\u95e8\u5e97\u6570` ,a.secpay_new_poi_cnt `\u79d2\u4ed8\u65b0\u589e\u95e8\u5e97\u6570` ,a.paybox_new_poi_cnt `\u5c0f\u767d\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,a.blackbox_new_poi_cnt `\u5c0f\u9ed1\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,a.all_coop_poi_cnt `\u5408\u4f5c\u95e8\u5e97\u6570` ,a.pos_coop_poi_cnt `pos\u5408\u4f5c\u95e8\u5e97\u6570` ,a.qrc_coop_poi_cnt `\u4e8c\u7ef4\u7801\u5408\u4f5c\u95e8\u5e97\u6570` ,a.secpay_coop_poi_cnt `\u79d2\u4ed8\u5408\u4f5c\u95e8\u5e97\u6570` ,a.paybox_coop_poi_cnt `\u5c0f\u767d\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` ,a.blackbox_coop_poi_cnt `\u5c0f\u9ed1\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` from ( select bd_id ,max(if(product_type=?,commit_poi_cnt,?)) as pos_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as pos_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as pos_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as pos_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as qrc_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as qrc_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as qrc_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as qrc_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as secpay_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as secpay_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as secpay_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as secpay_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as paybox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as paybox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as paybox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as paybox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as blackbox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as blackbox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as blackbox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as blackbox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as all_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as all_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as all_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as all_coop_poi_cnt ,partition_date from zcdatamart.app_bonus_bd_dim_all where partition_date between ? and ? and dt_type = ? and bd_id != ? group by bd_id ,partition_date )a left join zcdatamart.dim_dw_bd_orgtree_d b on a.bd_id = b.bd_id where (b.org_id in(?+) or b.org_unit_id in(?+) or b.region_id in(?+) or b.district_id in(?+) or b.state_id in(?+) )",
                "queryCount": 15,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027202
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select partition_date ,case when product_type=? then ? else product_type end as product_type ,case when channel=? then ? when channel=? then ? else channel end as channel ,(case when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? when product_type=? then ? end) as product_order ,(case when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? when channel=? then ? end) as channel_order ,order_cnt ,gpv ,poicnt ,purenewpoicnt ,active_poicnt ,pinrate\/? as pinrate ,avg_poi_gpv ,avg_poi_order_cnt ,orderprice ,if(order_cnt>?,card_cnt\/order_cnt,?) card_order_rate ,if(order_cnt>?,wechat_cnt\/order_cnt,?) wechat_order_rate ,if(order_cnt>?,alipay_cnt\/order_cnt,?) alipay_order_rate ,if(gpv>?,card_gpv\/gpv,?) card_gpv_rate ,if(gpv>?,wechat_gpv\/gpv,?) wechat_gpv_rate ,if(gpv>?,alipay_gpv\/gpv,?) alipay_gpv_rate ,card_cnt ,wechat_cnt ,alipay_cnt ,card_gpv ,wechat_gpv ,alipay_gpv from app_trade_core_data_channel_a_d where partition_date between ? and ? order by partition_date desc ,product_order ,channel_order limit ?",
                "queryCount": 12,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027203
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u57ce\u5e02\u5e38\u89c4\u76d1\u63a7 \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u5f90\u9e4f\u98de(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,?))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ,sum(a.sd_cnt) `\u4e0a\u5355poi\u6570` ,sum(a.sh_cnt) `\u5ba1\u6838poi\u6570` ,sum(a.new_poi_cnt) `\u8fdb\u5e97poi\u6570` ,sum(if(? = ? or a.partition_date = ?, a.online_poi_cnt, ?)) `\u5728\u7ebfpoi\u6570` ,round(avg(a.trade_cnt), ?) `\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount), ?) `\u65e5\u5747gpv` ,sum(a.trade_cnt) `\u8ba2\u5355\u6570` ,sum(a.trade_amount) `gpv` ,round(avg(a.trade_cnt\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747gpv` ,if(? = ? or ? = ?, a.device_cnt,?) `\u8bbe\u5907\u6570` ,concat(round(avg(a.trade_poi_cnt\/a.online_poi_cnt) * ?, ?), ?) `\u52a8\u9500\u7387 ` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ,sum(d.trade_cnt) trade_cnt ,sum(d.trade_amount) trade_amount ,sum(new_poi_cnt) new_poi_cnt ,sum(trade_poi_cnt) trade_poi_cnt ,sum(online_poi_cnt) online_poi_cnt ,sum(device_cnt) device_cnt ,sum(sd_cnt) sd_cnt ,sum(sh_cnt) sh_cnt ,sum(yx_cnt) yx_cnt from ( select t?te as partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt as trade_cnt ,t?total_trade_amount as trade_amount ,t?org_id ,t?org_unit_id ,t?rea_id ,t?region_id ,t?istrict_id ,t?state_id ,t?p_id ,t?org_leader_id ,t?vice_cnt ,t?online_poi_cnt ,t?new_poi_cnt ,t?sd_cnt ,t?sh_cnt ,t?yx_cnt ,t?trade_poi_cnt from zcdatamart.app_bd_zcm_pay_info_d t? force index(date_source_db_id_idx) left join zcdatamart.dim_dw_bd_orgtree_d t? on t?_id = t?_id where t?te between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ? ,t?source = ?))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?rea_id, t?region_id, t?istrict_id, t?state_id, t?p_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02",
                "queryCount": 11,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027208
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select substr(a.partition_date,?,?) as `\u7edf\u8ba1\u65e5\u671f` ,case when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? else ? end `\u4ea7\u54c1` ,a.state_name `\u90e8\u95e8` ,a.total_trade_cnt `\u4ea4\u6613\u7b14\u6570` ,a.avg_total_trade_cnt `\u65e5\u5747\u4ea4\u6613\u7b14\u6570` ,a.total_trade_amount `gpv` ,a.avg_total_trade_amount `\u65e5\u5747gpv` ,a.coop_poi_cnt `\u5408\u4f5c\u95e8\u5e97\u6570` ,a.new_poi_cnt `\u65b0\u589e\u95e8\u5e97\u6570` ,a.active_poi_cnt `\u6d3b\u8dc3\u95e8\u5e97\u6570` ,a.active_poi_rate `\u6d3b\u8dc3\u7387` ,a.avg_active_poi_rate `\u65e5\u5747\u6d3b\u8dc3\u7387` ,a.avg_cnt_perpoi `\u5355\u95e8\u5e97\u65e5\u5747\u4ea4\u6613\u7b14\u6570` ,a.avg_amt_perpoi `\u5355\u95e8\u5e97\u65e5\u5747gpv` from zcdatamart.app_bonus_bd_dim_all a inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ? ) c on a.state_id = c.auth_org_id where a.partition_date between ? and ? and a.product_type = ? and a.district_id = ? and a.dt_type = ? limit ?",
                "queryCount": 10,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027210
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select a.poi_id `\u95e8\u5e97id` ,a.poi_name `\u95e8\u5e97\u540d` ,a.main_poi_id `\u4e3b\u95e8\u5e97id` ,a.category_name `\u4e8c\u7ea7\u54c1\u7c7b` ,max(if(a.is_est_source=?,?,?)) `\u662f\u5426\u9057\u4ea7` ,concat(b.employee_name,?,b.mis_name,if(b.job_status = ?, ?, ?)) `bd` ,a.state_name `\u90e8\u95e8` ,a.district_name `\u5927\u533a` ,a.region_name `\u533a\u57df` ,a.org_unit_name `\u57ce\u5e02` ,a.org_name `\u5c0f\u7ec4` ,max(if(a.source=? and a.is_bind=?,?,?)) `pos\u662f\u5426\u7ed1\u5b9a` ,max(if(a.source=? and a.is_bind=?,?,?)) `\u76d2\u5b50\u662f\u5426\u7ed1\u5b9a` ,coalesce(max(if(a.source=? and a.commit_date!=?,a.commit_date,?)),?) `pos\u4e0a\u5355\u65e5\u671f` ,coalesce(max(if(a.source=? and a.commit_date!=?,a.commit_date,?)),?) `\u4e8c\u7ef4\u7801\u4e0a\u5355\u65e5\u671f` ,coalesce(max(if(a.source=? and a.commit_date!=?,a.commit_date,?)),?) `\u79d2\u4ed8\u4e0a\u5355\u65e5\u671f` ,coalesce(max(if(a.source=? and a.commit_date!=?,a.commit_date,?)),?) `\u5c0f\u767d\u76d2\u4e0a\u5355\u65e5\u671f` ,coalesce(max(if(a.source=? and a.commit_date!=?,a.commit_date,?)),?) `\u5c0f\u9ed1\u76d2\u4e0a\u5355\u65e5\u671f` ,coalesce(max(if(a.source=? and a.final_audit_date!=?,a.final_audit_date,?)),?) `pos\u5ba1\u6838\u65e5\u671f` ,coalesce(max(if(a.source=? and a.final_audit_date!=?,a.final_audit_date,?)),?) `\u4e8c\u7ef4\u7801\u5ba1\u6838\u65e5\u671f` ,coalesce(max(if(a.source=? and a.final_audit_date!=?,a.final_audit_date,?)),?) `\u79d2\u4ed8\u5ba1\u6838\u65e5\u671f` ,coalesce(max(if(a.source=? and a.final_audit_date!=?,a.final_audit_date,?)),?) `\u5c0f\u767d\u76d2\u5ba1\u6838\u65e5\u671f` ,coalesce(max(if(a.source=? and a.final_audit_date!=?,a.final_audit_date,?)),?) `\u5c0f\u9ed1\u76d2\u5ba1\u6838\u65e5\u671f` ,coalesce(max(if(a.source=? and a.first_trade_date!=?,a.first_trade_date,?)),?) `pos\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.first_trade_date!=?,a.first_trade_date,?)),?) `\u4e8c\u7ef4\u7801\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.first_trade_date!=?,a.first_trade_date,?)),?) `\u79d2\u4ed8\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.first_trade_date!=?,a.first_trade_date,?)),?) `\u5c0f\u767d\u76d2\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.first_trade_date!=?,a.first_trade_date,?)),?) `\u5c0f\u9ed1\u76d2\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.last_trade_date!=?,a.last_trade_date,?)),?) `pos\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.last_trade_date!=?,a.last_trade_date,?)),?) `\u4e8c\u7ef4\u7801\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.last_trade_date!=?,a.last_trade_date,?)),?) `\u79d2\u4ed8\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.last_trade_date!=?,a.last_trade_date,?)),?) `\u5c0f\u767d\u76d2\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.source=? and a.last_trade_date!=?,a.last_trade_date,?)),?) `\u5c0f\u9ed1\u76d2\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` ,coalesce(min(if(a.first_trade_date!=?,a.first_trade_date,?)),?) `\u95e8\u5e97\u9996\u4ea4\u6613\u65e5\u671f` ,coalesce(max(if(a.last_trade_date!=?,a.last_trade_date,?)),?) `\u95e8\u5e97\u6700\u540e\u4e00\u6b21\u4ea4\u6613\u65e5\u671f` from zcdatamart.app_bonus_monitior_poi_life_d a left join zcdatamart.dim_dw_bd_orgtree_d b on a.bd_id = b.bd_id where a.partition_date=? and case when ? != ? then a.main_poi_id = ? else ?=? end and case when ? != ? then a.poi_id = ? else ?=? end and case when ? != ? then a.mis_name = ? else ?=? end ? case when (select bd_id from mart_zcm.int_zcm_bd_orgtree where bd_id=? and bd_level=? and partition_date=?) is not ? then a.bd_id=? else ?=? end and ( b.org_id in(?+) or b.org_unit_id in(?+) or b.region_id in(?+) or b.district_id in(?+) or b.state_id in(?+) ) group by a.poi_id ,a.poi_name ,a.main_poi_id ,a.category_name ,concat(b.employee_name,?,b.mis_name,if(b.job_status = ?, ?, ?)) ,a.state_name ,a.district_name ,a.region_name ,a.org_unit_name ,a.org_name limit ?",
                "queryCount": 9,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027211
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select partition_date ,case when product_type = ? then ? when product_type = ? then ? when product_type = ? then ? when product_type = ? then ? when product_type = ? then ? when product_type = ? then ? end as product_type ,case when is_dining = ? then ? when is_dining = ? then ? when is_dining = ? then ? when is_dining = ? then ? end as is_dining ,case when fst_trade_district_name = ? then ? else fst_trade_district_name end as fst_trade_district_name ,case when fst_trade_region_name = ? then ? else fst_trade_region_name end as fst_trade_region_name ,case when fst_trade_org_unit_name = ? then ? else fst_trade_org_unit_name end as fst_trade_org_unit_name ,new_poi_cnt ,retention_poi_cnt_w? ,retention_rate_w? ,retention_poi_cnt_w? ,retention_rate_w? ,retention_poi_cnt_w? ,retention_rate_w? ,retention_poi_cnt_w? ,retention_rate_w? ,retention_poi_cnt_w? ,retention_rate_w? ,retention_poi_cnt_w? ,retention_rate_w? from zcdatamart.app_retention_analysis_rpt?_d where partition_date between ? and ?",
                "queryCount": 6,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027216
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u4e1a\u7ee9_bd\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u7eaa\u4f1f(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,if(? = ?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.trade_cnt) `\u4ea4\u6613\u8ba2\u5355` ,sum(a.trade_amount) `\u4ea4\u6613\u989d` ,sum(a.poi_xz) `\u65b0\u589e\u95e8\u5e97\u6570` ,sum(a.pos_xz) `\u65b0\u589epos\u95e8\u5e97\u6570` ,sum(a.qrc_xz) `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,sum(a.sec_xz) `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,sum(a.paybox_xz) `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,max(a.poi_hz) `\u5408\u4f5c\u95e8\u5e97\u6570` ,max(a.pos_hz) `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,max(a.qrc_hz) `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,max(a.sec_hz) `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,max(a.paybox_hz) `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(pos_coop_poi_cnt) pos_hz ,sum(pos_newadd_poi_cnt) pos_xz ,max(qrc_coop_poi_cnt) qrc_hz ,sum(qrc_newadd_poi_cnt) qrc_xz ,max(secpay_coop_poi_cnt) sec_hz ,sum(secpay_newadd_poi_cnt) sec_xz ,max(paybox_coop_poi_cnt) paybox_hz ,sum(paybox_newadd_poi_cnt) paybox_xz ,max(coop_poi_cnt) poi_hz ,sum(newadd_poi_cnt) poi_xz ,sum(is_new_poi_cnt) is_new_cnt ,sum(is_poi_p_type_cnt) is_poi_p_type_cnt ,sum(is_new_poi_p_type_cnt) is_new_poi_p_type_cnt from ( select t?partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt ,t?total_trade_amount ,t?org_id ,t?org_unit_id ,t?region_id ,t?istrict_id ,t?state_id ,t?pos_coop_poi_cnt ,t?pos_newadd_poi_cnt ,t?qrc_coop_poi_cnt ,t?qrc_newadd_poi_cnt ,t?secpay_coop_poi_cnt ,t?secpay_newadd_poi_cnt ,t?paybox_coop_poi_cnt ,t?paybox_newadd_poi_cnt ,t?oop_poi_cnt ,t?newadd_poi_cnt ,case when t?source = ? then t?is_new_poi_cnt else ? end as is_new_poi_cnt ,case when t?source = ? then t?is_poi_p_type_cnt else ? end as is_poi_p_type_cnt ,t?is_new_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ?,if(?=?,t?source = ?,t?source = ?)))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?region_id, t?istrict_id, t?state_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 5,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027218
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), concat(date_add(a.partition_date,interval ? day),?,a.partition_date))) as `\u7edf\u8ba1\u65e5\u671f` ,case when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? when a.product_type = ? then ? else ? end `\u4ea7\u54c1` ,b.state_name `\u90e8\u95e8` ,b.district_name `\u5927\u533a` ,b.region_name `\u533a\u57df` ,b.area_name `\u5206\u533a` ,b.org_unit_name `\u57ce\u5e02` ,b.org_name `\u5c0f\u7ec4` ,concat(b.employee_name,?,b.mis_name,if(b.job_status = ?, ?, ?)) `bd` ,if(b.job_status=?,?,if(b.job_status=?,?,?)) `\u5728\u804c\u72b6\u6001` ,b.bd_id `bd_id` ,a.total_trade_cnt `\u4ea4\u6613\u7b14\u6570` ,a.avg_total_trade_cnt `\u65e5\u5747\u4ea4\u6613\u7b14\u6570` ,a.total_trade_amount `gpv` ,a.avg_total_trade_amount `\u65e5\u5747gpv` ,a.coop_poi_cnt `\u5408\u4f5c\u95e8\u5e97\u6570` ,a.new_poi_cnt `\u65b0\u589e\u95e8\u5e97\u6570` ,a.active_poi_cnt `\u6d3b\u8dc3\u95e8\u5e97\u6570` ,a.active_poi_rate `\u6d3b\u8dc3\u7387` ,a.avg_active_poi_rate `\u65e5\u5747\u6d3b\u8dc3\u7387` ,a.avg_cnt_perpoi `\u5355\u95e8\u5e97\u65e5\u5747\u4ea4\u6613\u7b14\u6570` ,a.avg_amt_perpoi `\u5355\u95e8\u5e97\u65e5\u5747gpv` ,a.partition_date `\u5feb\u7167\u65e5\u671f` from zcdatamart.app_bonus_bd_dim_all a left join zcdatamart.dim_dw_bd_orgtree_d b on a.bd_id = b.bd_id where a.partition_date between ? and ? and a.dt_type = ? and a.product_type = ? and (b.org_id in(?+) or b.org_unit_id in(?+) or b.region_id in(?+) or b.district_id in(?+) or b.state_id in(?+) ) and a.bd_id <> ? order by a.partition_date,a.bd_id limit ?",
                "queryCount": 5,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027219
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u4e1a\u7ee9_bd\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u9093\u6b66\u7acb(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,if(? = ?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.trade_cnt) `\u4ea4\u6613\u8ba2\u5355` ,sum(a.trade_amount) `\u4ea4\u6613\u989d` ,sum(a.poi_xz) `\u65b0\u589e\u95e8\u5e97\u6570` ,sum(a.pos_xz) `\u65b0\u589epos\u95e8\u5e97\u6570` ,sum(a.qrc_xz) `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,sum(a.sec_xz) `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,sum(a.paybox_xz) `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,max(a.poi_hz) `\u5408\u4f5c\u95e8\u5e97\u6570` ,max(a.pos_hz) `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,max(a.qrc_hz) `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,max(a.sec_hz) `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,max(a.paybox_hz) `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(pos_coop_poi_cnt) pos_hz ,sum(pos_newadd_poi_cnt) pos_xz ,max(qrc_coop_poi_cnt) qrc_hz ,sum(qrc_newadd_poi_cnt) qrc_xz ,max(secpay_coop_poi_cnt) sec_hz ,sum(secpay_newadd_poi_cnt) sec_xz ,max(paybox_coop_poi_cnt) paybox_hz ,sum(paybox_newadd_poi_cnt) paybox_xz ,max(coop_poi_cnt) poi_hz ,sum(newadd_poi_cnt) poi_xz ,sum(is_new_poi_cnt) is_new_cnt ,sum(is_poi_p_type_cnt) is_poi_p_type_cnt ,sum(is_new_poi_p_type_cnt) is_new_poi_p_type_cnt from ( select t?partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt ,t?total_trade_amount ,t?org_id ,t?org_unit_id ,t?region_id ,t?istrict_id ,t?state_id ,t?pos_coop_poi_cnt ,t?pos_newadd_poi_cnt ,t?qrc_coop_poi_cnt ,t?qrc_newadd_poi_cnt ,t?secpay_coop_poi_cnt ,t?secpay_newadd_poi_cnt ,t?paybox_coop_poi_cnt ,t?paybox_newadd_poi_cnt ,t?oop_poi_cnt ,t?newadd_poi_cnt ,case when t?source = ? then t?is_new_poi_cnt else ? end as is_new_poi_cnt ,case when t?source = ? then t?is_poi_p_type_cnt else ? end as is_poi_p_type_cnt ,t?is_new_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ?,if(?=?,t?source = ?,t?source = ?)))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?region_id, t?istrict_id, t?state_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 4,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027223
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u76ee\u6807\u8fbe\u6210\u60c5\u51b5\uff08\u533a\u57df\uff09 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u5f90\u9e4f\u98de(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_rank `\u57ce\u5e02\u7b49\u7ea7` ,t?trade_cnt `\u4ea4\u6613\u7b14\u6570` ,t?total_trade_cnt_goal `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_poi_trade_cnt `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_trade_cnt_goal `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?)!=?,concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?),?) `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?pre_trade_cnt `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?pre_trade_cnt_goal `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?)!=?,concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?),?) `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?remain_trade_cnt `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?remain_trade_cnt_goal `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?)!=?,concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?),?) `\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?st_trade_cnt `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?st_trade_cnt_goal `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?)!=?,concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?),?) `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_est_trade_cnt `\u672c\u6708\u65b0\u589e\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?)!=?,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?)!=?,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?trade_amt `\u4ea4\u6613\u6d41\u6c34` from ( select dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_goal, if(? = ?,cd_region_new_poi_goal,region_new_poi_goal))),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_heavy_poi_goal, if(? = ?,cd_region_heavy_poi_goal,region_heavy_poi_goal))),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(if(? = ?,sab_region_total_trade_cnt_goal, if(? = ?,cd_region_total_trade_cnt_goal,region_total_trade_cnt_goal))),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_remain_trade_cnt_goal, if(? = ?,cd_region_remain_trade_cnt_goal,region_remain_trade_cnt_goal))),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_pre_trade_cnt_goal, if(? = ?,cd_region_pre_trade_cnt_goal,region_pre_trade_cnt_goal))),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_trade_cnt_goal, if(? = ?,cd_region_new_poi_trade_cnt_goal,region_new_poi_trade_cnt_goal))),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_est_trade_cnt_goal, if(? = ?,cd_region_est_trade_cnt_goal,region_est_trade_cnt_goal))),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) union all select dep_name ,state_name ,district_name ,region_name ,? as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(region_new_poi_goal),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(region_heavy_poi_goal),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(region_total_trade_cnt_goal),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(region_remain_trade_cnt_goal),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(region_pre_trade_cnt_goal),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(region_new_poi_trade_cnt_goal),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(region_est_trade_cnt_goal),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? where t?org_rank = ? order by if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) desc limit ?",
                "queryCount": 4,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027224
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u57ce\u5e02\u5e38\u89c4\u76d1\u63a7 \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u5f90\u9e4f\u98de(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,?))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.sd_cnt) `\u4e0a\u5355poi\u6570` ,sum(a.sh_cnt) `\u5ba1\u6838poi\u6570` ,sum(a.new_poi_cnt) `\u8fdb\u5e97poi\u6570` ,sum(if(? = ? or a.partition_date = ?, a.online_poi_cnt, ?)) `\u5728\u7ebfpoi\u6570` ,round(avg(a.trade_cnt), ?) `\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount), ?) `\u65e5\u5747gpv` ,sum(a.trade_cnt) `\u8ba2\u5355\u6570` ,sum(a.trade_amount) `gpv` ,round(avg(a.trade_cnt\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747gpv` ,if(? = ? or ? = ?, a.device_cnt,?) `\u8bbe\u5907\u6570` ,concat(round(avg(a.trade_poi_cnt\/a.online_poi_cnt) * ?, ?), ?) `\u52a8\u9500\u7387 ` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.trade_cnt) trade_cnt ,sum(d.trade_amount) trade_amount ,sum(new_poi_cnt) new_poi_cnt ,sum(trade_poi_cnt) trade_poi_cnt ,sum(online_poi_cnt) online_poi_cnt ,sum(device_cnt) device_cnt ,sum(sd_cnt) sd_cnt ,sum(sh_cnt) sh_cnt ,sum(yx_cnt) yx_cnt from ( select t?te as partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt as trade_cnt ,t?total_trade_amount as trade_amount ,t?org_id ,t?org_unit_id ,t?rea_id ,t?region_id ,t?istrict_id ,t?state_id ,t?p_id ,t?org_leader_id ,t?vice_cnt ,t?online_poi_cnt ,t?new_poi_cnt ,t?sd_cnt ,t?sh_cnt ,t?yx_cnt ,t?trade_poi_cnt from zcdatamart.app_bd_zcm_pay_info_d t? force index(date_source_db_id_idx) left join zcdatamart.dim_dw_bd_orgtree_d t? on t?_id = t?_id where t?te between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ? ,t?source = ?))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?rea_id, t?region_id, t?istrict_id, t?state_id, t?p_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 4,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027227
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bd_trade_status_rpt_d` where dt <= ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027228
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bd_trade_status_rpt_d` where dt = ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027229
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_ska_poi_detail_report_a_info` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027230
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select partition_date ,product_type ,channel ,order_cnt ,gpv ,poicnt ,purenewpoicnt ,pinrate\/? as pinrate ,avg_poi_gpv ,avg_poi_order_cnt ,orderprice ,if(order_cnt>?,card_cnt\/order_cnt,?) card_order_rate ,if(order_cnt>?,wechat_cnt\/order_cnt,?) wechat_order_rate ,if(order_cnt>?,alipay_cnt\/order_cnt,?) alipay_order_rate ,if(gpv>?,card_gpv\/gpv,?) card_gpv_rate ,if(gpv>?,wechat_gpv\/gpv,?) wechat_gpv_rate ,if(gpv>?,alipay_gpv\/gpv,?) alipay_gpv_rate ,card_cnt ,wechat_cnt ,alipay_cnt ,card_gpv ,wechat_gpv ,alipay_gpv from app_trade_core_data_channel_a_d where partition_date between ? and ? order by partition_date ,product_type ,channel desc limit ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027231
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select partition_date ,poi_id ,poi_name ,pos_first_trade_date ,qr_first_trade_date ,sec_first_trade_date ,city_name ,classname ,categoryname ,dinner_typename ,total_cnt ,total_gpv ,pos_cnt ,qr_cnt ,secpay_cnt ,pos_gpv ,qr_gpv ,secpay_gpv ,total_card_cnt ,total_wechat_cnt ,total_alipay_cnt ,total_mt_cnt ,total_card_gpv ,total_wechat_gpv ,total_alipay_gpv ,total_mt_gpv from zcdatamart.app_poi_trade_all_m where partition_date between ?and ? and poi_id in(?+) order by partition_date",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027234
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select t?partition_date `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?rea_name `\u5206\u533a` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u5c0f\u7ec4` ,case when t?state_id is not ? and t?istrict_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?rea_id is ? and t?org_unit_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?rea_id is not ? and t?org_unit_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?org_unit_id is not ? and t?org_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?org_unit_id is not ? and t?org_id is not ? and t?_id is ? then ? else ? end `\u57ce\u5e02\u7ef4\u5ea6` ,t?ll_commit_poi_cnt `\u4e0a\u5355\u95e8\u5e97\u6570` ,t?pos_commit_poi_cnt `pos\u4e0a\u5355\u95e8\u5e97\u6570` ,t?qrc_commit_poi_cnt `\u4e8c\u7ef4\u7801\u4e0a\u5355\u95e8\u5e97\u6570` ,t?secpay_commit_poi_cnt `\u79d2\u4ed8\u4e0a\u5355\u95e8\u5e97\u6570` ,t?paybox_commit_poi_cnt `\u5c0f\u767d\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,t?lackbox_commit_poi_cnt `\u5c0f\u9ed1\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,t?ll_bind_poi_cnt `\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?pos_bind_poi_cnt `pos\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?qrc_bind_poi_cnt `\u4e8c\u7ef4\u7801\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?secpay_bind_poi_cnt `\u79d2\u4ed8\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?paybox_bind_poi_cnt `\u5c0f\u767d\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?lackbox_bind_poi_cnt `\u5c0f\u9ed1\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?ll_new_poi_cnt `\u65b0\u589e\u95e8\u5e97\u6570` ,t?pos_new_poi_cnt `pos\u65b0\u589e\u95e8\u5e97\u6570` ,t?qrc_new_poi_cnt `\u4e8c\u7ef4\u7801\u65b0\u589e\u95e8\u5e97\u6570` ,t?secpay_new_poi_cnt `\u79d2\u4ed8\u65b0\u589e\u95e8\u5e97\u6570` ,t?paybox_new_poi_cnt `\u5c0f\u767d\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,t?lackbox_new_poi_cnt `\u5c0f\u9ed1\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,t?ll_coop_poi_cnt `\u5408\u4f5c\u95e8\u5e97\u6570` ,t?pos_coop_poi_cnt `pos\u5408\u4f5c\u95e8\u5e97\u6570` ,t?qrc_coop_poi_cnt `\u4e8c\u7ef4\u7801\u5408\u4f5c\u95e8\u5e97\u6570` ,t?secpay_coop_poi_cnt `\u79d2\u4ed8\u5408\u4f5c\u95e8\u5e97\u6570` ,t?paybox_coop_poi_cnt `\u5c0f\u767d\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` ,t?lackbox_coop_poi_cnt `\u5c0f\u9ed1\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` from ( select if(state_id=?,?,state_id) state_id ,state_name ,if(district_id=?,?,district_id) district_id ,district_name ,if(region_id=?,?,region_id) region_id ,region_name ,if(area_id=?,?,area_id) area_id ,area_name ,if(org_unit_id=?,?,org_unit_id) org_unit_id ,org_unit_name ,if(org_id=?,?,org_id) org_id ,org_name ,if(bd_id=?,?,bd_id) bd_id ,max(if(product_type=?,commit_poi_cnt,?)) as pos_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as pos_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as pos_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as pos_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as qrc_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as qrc_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as qrc_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as qrc_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as secpay_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as secpay_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as secpay_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as secpay_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as paybox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as paybox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as paybox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as paybox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as blackbox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as blackbox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as blackbox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as blackbox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as all_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as all_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as all_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as all_coop_poi_cnt ,partition_date from zcdatamart.app_bonus_bd_dim_all where partition_date between ? and ? and dt_type = ? and bd_id=? group by partition_date ,state_id ,state_name ,district_id ,district_name ,region_id ,region_name ,area_id ,area_name ,org_unit_id ,org_unit_name ,org_id ,org_name ,bd_id )t? inner join ( select auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ? group by auth_org_id )t? on coalesce(t?org_id,t?org_unit_id,t?region_id,t?istrict_id,t?state_id) = t?uth_org_id order by t?partition_date,t?ll_new_poi_cnt desc limit ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027237
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `mtcoop_bank_info` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcm_coop_etl",
                "sqlId": 65027247
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u57ce\u5e02\u5e38\u89c4\u76d1\u63a7 \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u5468\u536b(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,?))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ,sum(a.sd_cnt) `\u4e0a\u5355poi\u6570` ,sum(a.sh_cnt) `\u5ba1\u6838poi\u6570` ,sum(a.new_poi_cnt) `\u8fdb\u5e97poi\u6570` ,sum(if(? = ? or a.partition_date = ?, a.online_poi_cnt, ?)) `\u5728\u7ebfpoi\u6570` ,round(avg(a.trade_cnt), ?) `\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount), ?) `\u65e5\u5747gpv` ,sum(a.trade_cnt) `\u8ba2\u5355\u6570` ,sum(a.trade_amount) `gpv` ,round(avg(a.trade_cnt\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747\u8ba2\u5355\u6570` ,round(avg(a.trade_amount\/a.online_poi_cnt), ?) `\u5355poi\u65e5\u5747gpv` ,if(? = ? or ? = ?, a.device_cnt,?) `\u8bbe\u5907\u6570` ,concat(round(avg(a.trade_poi_cnt\/a.online_poi_cnt) * ?, ?), ?) `\u52a8\u9500\u7387 ` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ,sum(d.trade_cnt) trade_cnt ,sum(d.trade_amount) trade_amount ,sum(new_poi_cnt) new_poi_cnt ,sum(trade_poi_cnt) trade_poi_cnt ,sum(online_poi_cnt) online_poi_cnt ,sum(device_cnt) device_cnt ,sum(sd_cnt) sd_cnt ,sum(sh_cnt) sh_cnt ,sum(yx_cnt) yx_cnt from ( select t?te as partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt as trade_cnt ,t?total_trade_amount as trade_amount ,t?org_id ,t?org_unit_id ,t?rea_id ,t?region_id ,t?istrict_id ,t?state_id ,t?p_id ,t?org_leader_id ,t?vice_cnt ,t?online_poi_cnt ,t?new_poi_cnt ,t?sd_cnt ,t?sh_cnt ,t?yx_cnt ,t?trade_poi_cnt from zcdatamart.app_bd_zcm_pay_info_d t? force index(date_source_db_id_idx) left join zcdatamart.dim_dw_bd_orgtree_d t? on t?_id = t?_id where t?te between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ? ,t?source = ?))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?rea_id, t?region_id, t?istrict_id, t?state_id, t?p_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02 ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027253
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_device_apply` character set utf?m? fields terminated by ? escaped by ? (`device_apply_id`, `poi_id`, `coop_id`, `apply_num`, `applier_id`, `snap_shot`, `apply_type`, `last_apply_id`, `status`, `sync_photo`, `create_time`, `modify_time`, `fail_reason`, `acquirer_id`, `process_id`, `deposit_num`, `sold_num`, `free_num`, `audit_result`, `reject_reason`, `minus_type`, `merchant_type`, `merchant_id`, `bank_account_id`, `deposit_pay_type`, `sold_price`, `deposit_price`, `deposit_return_rule`)",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027255
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select substr(t?partition_date,?,?) `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?rea_name `\u5206\u533a` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u5c0f\u7ec4` ,case when t?state_id is not ? and t?istrict_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?rea_id is ? and t?org_unit_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?rea_id is not ? and t?org_unit_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?org_unit_id is not ? and t?org_id is ? then ? when t?state_id is not ? and t?istrict_id is not ? and t?region_id is not ? and t?org_unit_id is not ? and t?org_id is not ? and t?_id is ? then ? else ? end `\u57ce\u5e02\u7ef4\u5ea6` ,t?ll_commit_poi_cnt `\u4e0a\u5355\u95e8\u5e97\u6570` ,t?pos_commit_poi_cnt `pos\u4e0a\u5355\u95e8\u5e97\u6570` ,t?qrc_commit_poi_cnt `\u4e8c\u7ef4\u7801\u4e0a\u5355\u95e8\u5e97\u6570` ,t?secpay_commit_poi_cnt `\u79d2\u4ed8\u4e0a\u5355\u95e8\u5e97\u6570` ,t?paybox_commit_poi_cnt `\u5c0f\u767d\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,t?lackbox_commit_poi_cnt `\u5c0f\u9ed1\u76d2\u4e0a\u5355\u95e8\u5e97\u6570` ,t?ll_bind_poi_cnt `\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?pos_bind_poi_cnt `pos\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?qrc_bind_poi_cnt `\u4e8c\u7ef4\u7801\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?secpay_bind_poi_cnt `\u79d2\u4ed8\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?paybox_bind_poi_cnt `\u5c0f\u767d\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?lackbox_bind_poi_cnt `\u5c0f\u9ed1\u76d2\u7ed1\u5b9a\u95e8\u5e97\u6570` ,t?ll_new_poi_cnt `\u65b0\u589e\u95e8\u5e97\u6570` ,t?pos_new_poi_cnt `pos\u65b0\u589e\u95e8\u5e97\u6570` ,t?qrc_new_poi_cnt `\u4e8c\u7ef4\u7801\u65b0\u589e\u95e8\u5e97\u6570` ,t?secpay_new_poi_cnt `\u79d2\u4ed8\u65b0\u589e\u95e8\u5e97\u6570` ,t?paybox_new_poi_cnt `\u5c0f\u767d\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,t?lackbox_new_poi_cnt `\u5c0f\u9ed1\u76d2\u65b0\u589e\u95e8\u5e97\u6570` ,t?ll_coop_poi_cnt `\u5408\u4f5c\u95e8\u5e97\u6570` ,t?pos_coop_poi_cnt `pos\u5408\u4f5c\u95e8\u5e97\u6570` ,t?qrc_coop_poi_cnt `\u4e8c\u7ef4\u7801\u5408\u4f5c\u95e8\u5e97\u6570` ,t?secpay_coop_poi_cnt `\u79d2\u4ed8\u5408\u4f5c\u95e8\u5e97\u6570` ,t?paybox_coop_poi_cnt `\u5c0f\u767d\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` ,t?lackbox_coop_poi_cnt `\u5c0f\u9ed1\u76d2\u5408\u4f5c\u95e8\u5e97\u6570` from ( select if(state_id=?,?,state_id) state_id ,state_name ,if(district_id=?,?,district_id) district_id ,district_name ,if(region_id=?,?,region_id) region_id ,region_name ,if(area_id=?,?,area_id) area_id ,area_name ,if(org_unit_id=?,?,org_unit_id) org_unit_id ,org_unit_name ,if(org_id=?,?,org_id) org_id ,org_name ,if(bd_id=?,?,bd_id) bd_id ,max(if(product_type=?,commit_poi_cnt,?)) as pos_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as pos_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as pos_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as pos_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as qrc_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as qrc_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as qrc_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as qrc_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as secpay_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as secpay_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as secpay_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as secpay_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as paybox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as paybox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as paybox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as paybox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as blackbox_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as blackbox_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as blackbox_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as blackbox_coop_poi_cnt ,max(if(product_type=?,commit_poi_cnt,?)) as all_commit_poi_cnt ,max(if(product_type=?,bind_poi_cnt,?)) as all_bind_poi_cnt ,max(if(product_type=?,new_poi_cnt,?)) as all_new_poi_cnt ,max(if(product_type=?,coop_poi_cnt,?)) as all_coop_poi_cnt ,partition_date from zcdatamart.app_bonus_bd_dim_all where partition_date between ? and ? and dt_type = ? and bd_id=? group by partition_date ,state_id ,state_name ,district_id ,district_name ,region_id ,region_name ,if(area_id=?,?,area_id) ,area_name ,org_unit_id ,org_unit_name ,org_id ,org_name ,bd_id )t? inner join ( select auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ? group by auth_org_id )t? on coalesce(t?org_id,t?org_unit_id,t?region_id,t?istrict_id,t?state_id) = t?uth_org_id order by t?partition_date,t?ll_new_poi_cnt desc limit ?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027257
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select w.partition_date `\u65e5\u671f`, w.city_rank `\u57ce\u5e02\u7b49\u7ea7`, w.is_dining `\u662f\u5426\u6b63\u9910`, w.title `\u5e94\u7528\u540d\u79f0`, w.down_load_cnt `\u5f53\u65e5\u4e0b\u8f7d\u6b21\u6570`, w.down_load_device `\u5f53\u65e5\u4e0b\u8f7d\u8bbe\u5907\u6570`, w.down_load_device_rate `\u5f53\u65e5\u4e0b\u8f7d\u8bbe\u5907\u6570\u5360\u6bd4`, w.total_download_cnt `\u7d2f\u8ba1\u4e0b\u8f7d\u6b21\u6570`, w.total_download_device `\u7d2f\u8ba1\u4e0b\u8f7d\u8bbe\u5907\u6570`, w.total_download_device_rate `\u7d2f\u8ba1\u4e0b\u8f7d\u8bbe\u5907\u6570\u5360\u6bd4`, w.total_coop_device `\u603b\u8bbe\u5907\u6570` from (select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select a.city_rank , case when a.is_dining=? then ? when a.is_dining=? then ? else ? end as is_dining, a.title , a.down_load_cnt , a.down_load_device , round(a.down_load_device\/a.total_coop_device,?) down_load_device_rate, a.total_download_cnt , a.total_download_device , round(a.total_download_device\/a.total_coop_device) total_download_device_rate, a.total_coop_device , a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select ? city_rank, case when a.is_dining=? then ? when a.is_dining=? then ? else ? end as is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.is_dining, a.title, a.partition_date) d left join (select ? city_rank, case when b.is_dining=? then ? when b.is_dining=? then ? else ? end as is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.is_dining, b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select a.city_rank, ? is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.city_rank, a.title, a.partition_date) d left join (select b.city_rank, ? is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.city_rank, b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select ? city_rank, ? is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.title, a.partition_date) d left join (select ? city_rank, ? is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? ) w where w.partition_date between ? and ? order by `\u65e5\u671f`",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027261
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select w.partition_date `\u65e5\u671f`, w.city_rank `\u57ce\u5e02\u7b49\u7ea7`, w.is_dining `\u662f\u5426\u6b63\u9910`, w.title `\u5e94\u7528\u540d\u79f0`, w.down_load_cnt `\u5f53\u65e5\u4e0b\u8f7d\u6b21\u6570`, w.down_load_device `\u5f53\u65e5\u4e0b\u8f7d\u8bbe\u5907\u6570`, w.down_load_device_rate `\u5f53\u65e5\u4e0b\u8f7d\u8bbe\u5907\u6570\u5360\u6bd4`, w.total_download_cnt `\u7d2f\u8ba1\u4e0b\u8f7d\u6b21\u6570`, w.total_download_device `\u7d2f\u8ba1\u4e0b\u8f7d\u8bbe\u5907\u6570`, w.total_download_device_rate `\u7d2f\u8ba1\u4e0b\u8f7d\u8bbe\u5907\u6570\u5360\u6bd4`, w.total_coop_device `\u603b\u8bbe\u5907\u6570` from (select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select a.city_rank , case when a.is_dining=? then ? when a.is_dining=? then ? else ? end as is_dining, a.title , a.down_load_cnt , a.down_load_device , round(a.down_load_device\/a.total_coop_device,?) down_load_device_rate, a.total_download_cnt , a.total_download_device , round(a.total_download_device\/a.total_coop_device) total_download_device_rate, a.total_coop_device , a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select ? city_rank, case when a.is_dining=? then ? when a.is_dining=? then ? else ? end as is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.is_dining, a.title, a.partition_date) d left join (select ? city_rank, case when b.is_dining=? then ? when b.is_dining=? then ? else ? end as is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.is_dining, b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select a.city_rank, ? is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.city_rank, a.title, a.partition_date) d left join (select b.city_rank, ? is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.city_rank, b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? union all select z?partition_date , z?ity_rank , z?is_dining , z?title , z?own_load_cnt , z?own_load_device , z?own_load_device_rate , z?total_download_cnt , z?total_download_device , z?total_download_device_rate , z?total_coop_device from (select d.city_rank, d.is_dining, d.title, d.down_load_cnt , d.down_load_device, round(d.down_load_device\/c.total_coop_device,?) down_load_device_rate, d.total_download_cnt, d.total_download_device, round(d.total_download_device\/c.total_coop_device,?) total_download_device_rate, c.total_coop_device, d.partition_date from (select ? city_rank, ? is_dining, a.title, sum(a.down_load_cnt) down_load_cnt , sum(a.down_load_device) down_load_device, sum(a.total_download_cnt) total_download_cnt, sum(a.total_download_device) total_download_device, a.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d a group by a.title, a.partition_date) d left join (select ? city_rank, ? is_dining, sum(distinct b.total_coop_device) total_coop_device, b.partition_date from zcdatamart.app_pos_appstore_down_sum_i_d b group by b.partition_date) c on d.city_rank=c.city_rank and d.is_dining=c.is_dining and d.partition_date=c.partition_date) z? ) w where w.partition_date=?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027262
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u4e1a\u7ee9_bd\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u5f20\u6b23(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,if(? = ?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.trade_cnt) `\u4ea4\u6613\u8ba2\u5355` ,sum(a.trade_amount) `\u4ea4\u6613\u989d` ,sum(a.poi_xz) `\u65b0\u589e\u95e8\u5e97\u6570` ,sum(a.pos_xz) `\u65b0\u589epos\u95e8\u5e97\u6570` ,sum(a.qrc_xz) `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,sum(a.sec_xz) `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,sum(a.paybox_xz) `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,max(a.poi_hz) `\u5408\u4f5c\u95e8\u5e97\u6570` ,max(a.pos_hz) `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,max(a.qrc_hz) `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,max(a.sec_hz) `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,max(a.paybox_hz) `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(pos_coop_poi_cnt) pos_hz ,sum(pos_newadd_poi_cnt) pos_xz ,max(qrc_coop_poi_cnt) qrc_hz ,sum(qrc_newadd_poi_cnt) qrc_xz ,max(secpay_coop_poi_cnt) sec_hz ,sum(secpay_newadd_poi_cnt) sec_xz ,max(paybox_coop_poi_cnt) paybox_hz ,sum(paybox_newadd_poi_cnt) paybox_xz ,max(coop_poi_cnt) poi_hz ,sum(newadd_poi_cnt) poi_xz ,sum(is_new_poi_cnt) is_new_cnt ,sum(is_poi_p_type_cnt) is_poi_p_type_cnt ,sum(is_new_poi_p_type_cnt) is_new_poi_p_type_cnt from ( select t?partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt ,t?total_trade_amount ,t?org_id ,t?org_unit_id ,t?region_id ,t?istrict_id ,t?state_id ,t?pos_coop_poi_cnt ,t?pos_newadd_poi_cnt ,t?qrc_coop_poi_cnt ,t?qrc_newadd_poi_cnt ,t?secpay_coop_poi_cnt ,t?secpay_newadd_poi_cnt ,t?paybox_coop_poi_cnt ,t?paybox_newadd_poi_cnt ,t?oop_poi_cnt ,t?newadd_poi_cnt ,case when t?source = ? then t?is_new_poi_cnt else ? end as is_new_poi_cnt ,case when t?source = ? then t?is_poi_p_type_cnt else ? end as is_poi_p_type_cnt ,t?is_new_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ?,if(?=?,t?source = ?,t?source = ?)))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?region_id, t?istrict_id, t?state_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027275
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_shop` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `shop_name`, `poi_name`, `address`, `brand_id`, `brand_name`, `contract_person`, `contract_tel`, `create_date`, `create_time`, `modify_time`, `classid`, `classname`, `categoryid`, `categoryname`, `typeid`, `typename`, `org_id`, `org_name`, `city_id`, `city_name`, `is_close`, `ecom_account_id`, `bank_account_id`, `coop_id`, `is_paychannel`, `audit_result`, `reject_reason`, `money_flow`, `cash_proportion`, `location_id`, `hotel_supplierid`, `dp_account_id`, `dp_poi_id`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027277
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_qrc_poi` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027278
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u70df\u53f0?bd\u4e1a\u7ee9\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u811a\u672c\u6267\u884c(?) select a.yearmo `\u6708\u4efd` ,a.state_name `\u90e8\u95e8` ,a.district_name `\u5927\u533a` ,a.region_name `\u533a\u57df` ,a.org_unit_name `\u57ce\u5e02` ,a.org_name `\u5c0f\u7ec4` ,a.bd_id `bdid` ,a.bd `bd` ,a.mis_name `mis_name` ,a.trade_cnt `\u4ea4\u6613\u8ba2\u5355` ,a.trade_amount `\u4ea4\u6613\u989d` ,a.poi_xz `\u65b0\u589e\u95e8\u5e97\u6570` ,a.pos_xz `\u65b0\u589epos\u95e8\u5e97\u6570` ,a.qrc_xz `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,a.sec_xz `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,a.paybox_xz `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,a.poi_hz `\u5408\u4f5c\u95e8\u5e97\u6570` ,a.pos_hz `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,a.qrc_hz `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,a.sec_hz `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,a.paybox_hz `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` ,a.is_new_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,a.is_poi_p_type_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` from ( select t.yearmo ,t?state_name ,t?istrict_name ,t?region_name ,t?org_unit_name ,t?org_name ,d.bd_id ,d.bd ,d.mis_name ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(d.pos_coop_poi_cnt) pos_hz ,sum(d.pos_newadd_poi_cnt) pos_xz ,max(d.qrc_coop_poi_cnt) qrc_hz ,sum(d.qrc_newadd_poi_cnt) qrc_xz ,max(d.secpay_coop_poi_cnt) sec_hz ,sum(d.secpay_newadd_poi_cnt) sec_xz ,max(d.paybox_coop_poi_cnt) paybox_hz ,sum(d.paybox_newadd_poi_cnt) paybox_xz ,max(d.coop_poi_cnt) poi_hz ,sum(d.newadd_poi_cnt) poi_xz ,sum(d.is_new_poi_cnt) is_new_cnt ,sum(d.is_poi_p_type_cnt) is_poi_p_type_cnt from ( select t?partition_date ,t?_id ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) bd ,t?mis_name ,sum(t?total_trade_cnt) total_trade_cnt ,sum(t?total_trade_amount) total_trade_amount ,max(t?pos_coop_poi_cnt) pos_coop_poi_cnt ,sum(t?pos_newadd_poi_cnt) pos_newadd_poi_cnt ,max(t?qrc_coop_poi_cnt) qrc_coop_poi_cnt ,sum(t?qrc_newadd_poi_cnt) qrc_newadd_poi_cnt ,max(t?secpay_coop_poi_cnt) secpay_coop_poi_cnt ,sum(t?secpay_newadd_poi_cnt) secpay_newadd_poi_cnt ,max(t?paybox_coop_poi_cnt) paybox_coop_poi_cnt ,sum(t?paybox_newadd_poi_cnt) paybox_newadd_poi_cnt ,max(t?oop_poi_cnt) coop_poi_cnt ,sum(t?newadd_poi_cnt) newadd_poi_cnt ,sum(t?is_new_poi_cnt) is_new_poi_cnt ,sum(t?is_poi_p_type_cnt) is_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between concat(substr(?,?,?),?) and ? and t?partition_date>=? and t?source = ? group by t?partition_date ,t?_id ? ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) ,t?mis_name )d left join zcdatamart.dim_date t on d.partition_date = t.date left join zcdatamart.app_bonus_bd_perform_i_d t? on d.bd_id=t?_id and t?partition_date=? and t?source=? where t?org_unit_name=? group by t.yearmo ,t?state_name ,t?istrict_name ,t?region_name ,t?org_unit_name ,t?org_name ,d.bd_id ? ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) ,d.mis_name )a",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027280
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_hd_pos_monitor_d` character set utf?m? fields terminated by ? escaped by ? (stat_date,poi_id,poi_name,poi_first_trade_date,poi_city_id ,poi_city_name,poi_?st_category_id,poi_?st_category_name,bd_id,bd_name,bd_mis_name,bd_job_status,bd_area_id,bd_area_name,bd_district_id,bd_district_name,bd_org_unit_id,bd_org_unit_name,bd_org_id,bd_org_name,bd_state_id,bd_state_name,bd_dep_id ,bd_dep_name,bdm_id ,bdm_name,cm_id,cm_name,device_id,device_sn,online_time,offline_time,device_first_trade_date,sale_type,pay_type ,is_postpay,deduct_begin_time,deduct_end_time ,should_deduct_amount,will_deduct_amount ,is_open_recent_?ys,is_run_app_recent_?ys,avg_gpv_recent_?ys )",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027281
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `topic_bd_zcm_pay_info_d` character set utf?m? fields terminated by ? escaped by ? (`bd_id`, `position_id`, `dep_id`, `source`, `total_trade_amount`, `total_tc_trade_amount`, `weixin_trade_amount`, `zhifubao_trade_amount`, `yinhangka_trade_amount`, `yinhangka_tc_trade_amount`, `mt_trade_amount`, `total_trade_cnt`, `weixin_trade_cnt`, `zhifubao_trade_cnt`, `yinhangka_trade_cnt`, `online_poi_cnt`, `device_cnt`, `trade_poi_cnt`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027282
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_deposit_daily` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `poi_city_name`, `poi_city_id`, `poi_type`, `device_apply_id`, `apply_date`, `classname`, `classid`, `brand_id`, `brand_name`, `poi_first_trade_date`, `distribute_type`, `device_id`, `strategy_type`, `hd_device_sn`, `device_first_trade_date`, `deposit_money`, `deduct_type`, `deduct_status`, `deduct_complete_time`, `deduct_complete_month`, `audit_status`, `deduct_audit_complete_time`, `device_rank`, `coop_id`, `coop_date`, `poi_date`, `bd_id`, `job_status`, `mis_name`, `employee_name`, `position_id`, `org_id`, `org_name`, `dep_id`, `dep_name`, `state_id`, `state_name`, `district_id`, `district_name`, `region_id`, `region_name`, `org_unit_id`, `org_unit_name`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027283
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_hd_device_stage_ss` character set utf?m? fields terminated by ? escaped by ? (`hd_device_id`, `stage`, `device_mfr_id`, `device_sn`, `device_mode`, `device_type`, `acquirer_id`, `device_status`, `is_sign`, `device_loc_id`, `loc_name`, `from_loc_id`, `from_name`, `to_loc_id`, `to_name`, `flow_status`, `is_normal`, `is_installed`, `batch_no`, `token`, `sign_time`, `create_time`, `modify_time`, `biz`, `biz_name`, `from_biz`, `to_biz`, `owner_id`, `owner`, `device_id`, `poi_id`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027285
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bd_deposit_daily` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `poi_city_name`, `poi_city_id`, `poi_type`, `device_apply_id`, `apply_date`, `classname`, `classid`, `brand_id`, `brand_name`, `poi_first_trade_date`, `distribute_type`, `device_id`, `strategy_type`, `hd_device_sn`, `device_first_trade_date`, `deposit_money`, `deduct_type`, `deduct_status`, `deduct_complete_time`, `deduct_complete_month`, `coop_id`, `coop_date`, `poi_date`, `bd_id`, `job_status`, `mis_name`, `employee_name`, `position_id`, `org_id`, `org_name`, `dep_id`, `dep_name`, `state_id`, `state_name`, `district_id`, `district_name`, `region_id`, `region_name`, `org_unit_id`, `org_unit_name`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027286
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bd_trade_sum_i_d` character set utf?m? fields terminated by ? escaped by ? (`dep_id`, `dep_name`, `state_id`, `state_name`, `district_id`, `district_name`, `region_id`, `region_name`, `org_unit_id`, `org_unit_name`, `org_id`, `org_name`, `bd_id`, `mis_name`, `employee_name`, `product_type`, `new_poi_cnt`, `online_poi_cnt`, `active_poi_cnt`, `trade_amount`, `trade_cnt`, `per_poi_amount`, `per_poi_cnt`, `active_poi_rate`, `legacy_poi_cnt`, `legacy_trade_amount`, `legacy_trade_cnt`, `week_begin_date`, `yearmo`, `day_num_in_month`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027287
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_coop_bd_efficiency_w` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027288
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_poi_pos_daily` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `main_poi_id`, `city_id`, `city_name`, `classid`, `classname`, `categoryid`, `categoryname`, `typeid`, `typename`, `dinner_type`, `dinner_typename`, `first_trade_date`, `last_trade_date`, `pos_end_date`, `poi_end_date`, `trade_amount`, `pos_amount`, `pos_discount`, `zhifubao_amount`, `zhifubao_discount`, `weixin_amount`, `weixin_discount`, `yinhangka_amount`, `yinhangka_discount`, `pos_coupon_amount`, `pos_mopay_amount`, `trade_cnt`, `pos_cnt`, `zhifubao_cnt`, `weixin_cnt`, `yinhangka_cnt`, `pos_coupon_cnt`, `pos_mopay_cnt`, `is_new_poi`, `is_stop_poi`, `total_days`, `st_days`, `online_days`, `pos_days`, `coupon_days`, `only_coupon_days`, `device_cnt`, `trade_device_cnt`, `pos_device_cnt`, `only_coupon_device_cnt`, `coupon_device_cnt`, `new_pos_cnt`, `recall_pos_cnt`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027290
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u62db\u8d22\u732b_\u4f1a\u5458\u5546\u5bb6\u6c47\u603b\u8868 \u8d1f\u8d23\u4eba:\u6731\u4f1f \u67e5\u8be2\u4eba:\u811a\u672c\u6267\u884c(?) select city_rank ,city_name ,city_id ,org_id ,org_name ,member_id ,biz_id ,biz_name ,poi_num ,bd_id ,bd_name ,create_time ,is_related_app ,activity_num ,online_activity_num ,order_num ,related_app_num ,push_num ,pv ,uv ,take_num ,take_rate ,consume_num ,consume_rate ,partition_date from topic_mrk_member_biz_d where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027292
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mrk_biz_firstpage_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027294
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bonus_bd_dim_all` where partition_date >= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027295
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mrk_customer_firstpage_d where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027296
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `topic_flow_shop_stage` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027297
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bonus_monitor_poi_detail_d` where partition_date <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027298
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_coop_bd_efficiency_w` where week_begin_dt = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027299
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `detail_hd_device_stage_ss`",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027300
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bonus_monitior_poi_life_d` where partition_date <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027301
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_poi_bd_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027302
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_trade_poi_info` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027303
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_device_deposit` character set utf?m? fields terminated by ? escaped by ? (`device_id`, `hd_device_type`, `hd_device_id`, `hd_device_sn`, `poi_id`, `poi_name`, `poi_city_id`, `poi_city_name`, `brand_id`, `brand_name`, `close_status`, `classname`, `classid`, `coop_id`, `bd_id`, `bd_name`, `bd_dep_id`, `bd_dep_name`, `device_first_trade_date`, `distribute_type`, `minus_type`, `strategy_type`, `deduct_type`, `deposit_money`, `deduct_status`, `deduct_complete_time`, `deduct_begin_time`, `deduct_days`, `return_time`, `is_return`, `return_money`, `judge_date`, `create_time`, `modify_time`, `current_deposit_money`, `recent_settle_day`, `now_deduct_days`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027304
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_poi_info_d` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `bd_id`, `first_trade_bd`, `first_trade_date`, `first_trade_time`, `source`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027305
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_ska_poi_detail_report_a_info` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027306
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_hd_poi_monitor_d` where stat_date = ? or stat_date <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027308
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_qrc_bd_fs` character set utf?m? fields terminated by ? escaped by ? (`bd_id`, `mis_name`, `bd_name`, `leader_id`, `leader_mis_name`, `leader_name`, `org_unit_id`, `org_unit_name`, `dep_id`, `dep_name`, `is_fs`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027309
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:sep_poi_\u4ea7\u54c1_d \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u9b4f\u94ed\u9633(?) select if(? = ?,?,if(? = ?,?,if(?=?,?,if(?=?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,d.partition_date `\u65e5\u671f` ,d.employee_name `bd` ,d.state_name `\u90e8\u95e8` ,d.district_name `\u5927\u533a` ,d.region_name `\u533a\u57df` ,d.org_unit_name `\u57ce\u5e02` ,d.org_name `\u7ec4\u7ec7\u8282\u70b9` ,d.poi_id `poi_id` ,d.poi_name `\u95e8\u5e97\u540d\u79f0` ,d.is_est `\u662f\u5426\u9057\u4ea7` ,d.is_new `\u662f\u5426\u65b0\u95e8\u5e97` ,d.total_trade_cnt `\u8ba2\u5355\u6570` ,d.total_trade_amount `gpv` ,d.first_trade_date `\u9996\u4ea4\u6613\u65e5\u671f` from ( select if(? = ?, a.partition_date, ?) partition_date ,a.bd_id ,concat(c.employee_name, ?, c.mis_name, if(c.job_status = ?, ?, ?)) employee_name ,c.mis_name ,c.state_name ,c.district_name ,c.region_name ,c.org_unit_name ,c.org_name ,a.poi_id ,a.poi_name ,a.source ,a.main_poi_id ,min(a.first_trade_date) first_trade_date ,sum(a.total_trade_amount) total_trade_amount ,sum(a.total_trade_cnt) total_trade_cnt ,max(if(a.first_trade_date = a.partition_date,?,?)) is_new ,max(a.is_est) is_est ,c.org_id ,c.org_unit_id ,c.area_id ,c.region_id ,c.district_id ,c.state_id ,c.dep_id ,c.org_leader_id from app_bonus_poi_pay_d a join dim_dw_bd_orgtree_d c on a.bd_id = c.bd_id where a.partition_date between ? and ? and if(?=?,a.source = ? , if(?=?,a.source = ?,if(?=?,a.source = ?,if(?=?,a.source = ?,a.source = ?)))) and if(? != ?, a.poi_id = ?, if(? != ?, c.mis_name = ?, if(? > ?, ? in(c.org_id, c.org_unit_id, c.area_id, c.region_id, c.district_id, c.state_id, c.dep_id), c.bd_id = ?))) group by if(? = ?, a.partition_date, ?) ,a.poi_id ,a.bd_id ,a.source ,a.main_poi_id )d left join ( select if(? = ?, partition_date, ?) partition_date ,main_poi_id ,max(is_new) as is_new ,max(is_poi_p_type) as is_poi_p_type ,max(is_new_poi_p_type) as is_new_poi_p_type from app_bonus_poi_heavy_product_eff_d m where partition_date between ? and ? group by if(? = ?, partition_date, ?) ,main_poi_id )m on d.partition_date=m.partition_date and d.main_poi_id=m.main_poi_id limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027310
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_poi_eff_sep_d` character set utf?m? fields terminated by ? escaped by ? (`main_poi_id`, `main_poi_name`, `pos_first_bd`, `qrc_first_bd`, `secpay_first_bd`, `paybox_first_bd`, `pos_first_trade_poi_id`, `qrc_first_trade_poi_id`, `secpay_first_trade_poi_id`, `paybox_first_trade_poi_id`, `pos_first_trade_date`, `qrc_first_trade_date`, `secpay_first_trade_date`, `paybox_first_trade_date`, `first_trade_date`, `qrc_avg_trade_amount`, `qrc_avg_trade_cnt`, `avg_trade_amount`, `avg_trade_cnt`, `is_qrc_eff`, `is_poi_eff`, `qrc_effective_time`, `poi_effective_time`, `brand_id`, `brand_name`, `is_new`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027313
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u5317\u4eac\u4e09\u533a?bd\u4e1a\u7ee9\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u811a\u672c\u6267\u884c(?) select a.yearmo `\u6708\u4efd` ,a.state_name `\u90e8\u95e8` ,a.district_name `\u5927\u533a` ,a.region_name `\u533a\u57df` ,a.org_unit_name `\u57ce\u5e02` ,a.org_name `\u5c0f\u7ec4` ,a.bd_id `bdid` ,a.bd `bd` ,a.mis_name `mis_name` ,a.trade_cnt `\u4ea4\u6613\u8ba2\u5355` ,a.trade_amount `\u4ea4\u6613\u989d` ,a.poi_xz `\u65b0\u589e\u95e8\u5e97\u6570` ,a.pos_xz `\u65b0\u589epos\u95e8\u5e97\u6570` ,a.qrc_xz `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,a.sec_xz `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,a.paybox_xz `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,a.poi_hz `\u5408\u4f5c\u95e8\u5e97\u6570` ,a.pos_hz `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,a.qrc_hz `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,a.sec_hz `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,a.paybox_hz `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` ,a.is_new_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,a.is_poi_p_type_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` from ( select t.yearmo ,t?state_name ,t?istrict_name ,t?region_name ,t?org_unit_name ,t?org_name ,d.bd_id ,d.bd ,d.mis_name ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(d.pos_coop_poi_cnt) pos_hz ,sum(d.pos_newadd_poi_cnt) pos_xz ,max(d.qrc_coop_poi_cnt) qrc_hz ,sum(d.qrc_newadd_poi_cnt) qrc_xz ,max(d.secpay_coop_poi_cnt) sec_hz ,sum(d.secpay_newadd_poi_cnt) sec_xz ,max(d.paybox_coop_poi_cnt) paybox_hz ,sum(d.paybox_newadd_poi_cnt) paybox_xz ,max(d.coop_poi_cnt) poi_hz ,sum(d.newadd_poi_cnt) poi_xz ,sum(d.is_new_poi_cnt) is_new_cnt ,sum(d.is_poi_p_type_cnt) is_poi_p_type_cnt from ( select t?partition_date ,t?_id ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) bd ,t?mis_name ,sum(t?total_trade_cnt) total_trade_cnt ,sum(t?total_trade_amount) total_trade_amount ,max(t?pos_coop_poi_cnt) pos_coop_poi_cnt ,sum(t?pos_newadd_poi_cnt) pos_newadd_poi_cnt ,max(t?qrc_coop_poi_cnt) qrc_coop_poi_cnt ,sum(t?qrc_newadd_poi_cnt) qrc_newadd_poi_cnt ,max(t?secpay_coop_poi_cnt) secpay_coop_poi_cnt ,sum(t?secpay_newadd_poi_cnt) secpay_newadd_poi_cnt ,max(t?paybox_coop_poi_cnt) paybox_coop_poi_cnt ,sum(t?paybox_newadd_poi_cnt) paybox_newadd_poi_cnt ,max(t?oop_poi_cnt) coop_poi_cnt ,sum(t?newadd_poi_cnt) newadd_poi_cnt ,sum(t?is_new_poi_cnt) is_new_poi_cnt ,sum(t?is_poi_p_type_cnt) is_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between concat(substr(?,?,?),?) and ? and t?partition_date>=? and t?source = ? group by t?partition_date ,t?_id ? ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) ,t?mis_name )d left join zcdatamart.dim_date t on d.partition_date = t.date left join zcdatamart.app_bonus_bd_perform_i_d t? on d.bd_id=t?_id and t?partition_date=? and t?source=? where t?org_unit_name=? group by t.yearmo ,t?state_name ,t?istrict_name ,t?region_name ,t?org_unit_name ,t?org_name ,d.bd_id ? ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) ,d.mis_name )a",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027314
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u4e1a\u7ee9_bd\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u9ad8\u6653\u5a77(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,if(? = ?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.trade_cnt) `\u4ea4\u6613\u8ba2\u5355` ,sum(a.trade_amount) `\u4ea4\u6613\u989d` ,sum(a.poi_xz) `\u65b0\u589e\u95e8\u5e97\u6570` ,sum(a.pos_xz) `\u65b0\u589epos\u95e8\u5e97\u6570` ,sum(a.qrc_xz) `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,sum(a.sec_xz) `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,sum(a.paybox_xz) `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,max(a.poi_hz) `\u5408\u4f5c\u95e8\u5e97\u6570` ,max(a.pos_hz) `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,max(a.qrc_hz) `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,max(a.sec_hz) `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,max(a.paybox_hz) `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(pos_coop_poi_cnt) pos_hz ,sum(pos_newadd_poi_cnt) pos_xz ,max(qrc_coop_poi_cnt) qrc_hz ,sum(qrc_newadd_poi_cnt) qrc_xz ,max(secpay_coop_poi_cnt) sec_hz ,sum(secpay_newadd_poi_cnt) sec_xz ,max(paybox_coop_poi_cnt) paybox_hz ,sum(paybox_newadd_poi_cnt) paybox_xz ,max(coop_poi_cnt) poi_hz ,sum(newadd_poi_cnt) poi_xz ,sum(is_new_poi_cnt) is_new_cnt ,sum(is_poi_p_type_cnt) is_poi_p_type_cnt ,sum(is_new_poi_p_type_cnt) is_new_poi_p_type_cnt from ( select t?partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt ,t?total_trade_amount ,t?org_id ,t?org_unit_id ,t?region_id ,t?istrict_id ,t?state_id ,t?pos_coop_poi_cnt ,t?pos_newadd_poi_cnt ,t?qrc_coop_poi_cnt ,t?qrc_newadd_poi_cnt ,t?secpay_coop_poi_cnt ,t?secpay_newadd_poi_cnt ,t?paybox_coop_poi_cnt ,t?paybox_newadd_poi_cnt ,t?oop_poi_cnt ,t?newadd_poi_cnt ,case when t?source = ? then t?is_new_poi_cnt else ? end as is_new_poi_cnt ,case when t?source = ? then t?is_poi_p_type_cnt else ? end as is_poi_p_type_cnt ,t?is_new_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ?,if(?=?,t?source = ?,t?source = ?)))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?region_id, t?istrict_id, t?state_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027315
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_poi_org_pay_d` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `main_poi_id`, `main_poi_name`, `product_type`, `is_dining`, `address`, `brand_id`, `brand_name`, `class_id`, `class_name`, `category_id`, `category_name`, `type_id`, `type_name`, `poi_location_id`, `poi_location_name`, `poi_city_id`, `poi_city_name`, `poi_city_rank`, `poi_district_id`, `poi_district_name`, `close_status`, `barea_id`, `barea_name`, `first_trade_bd`, `bd_id`, `mis_name`, `employee_name`, `dep_id`, `dep_name`, `state_id`, `state_name`, `district_id`, `district_name`, `region_id`, `region_name`, `area_id`, `area_name`, `org_unit_id`, `org_unit_name`, `org_id`, `org_name`, `position_id`, `position_name`, `is_org_leader`, `job_status`, `org_id_path`, `entry_month`, `entry_date`, `position_type`, `first_trade_date`, `is_new_poi`, `total_trade_amount`, `total_trade_cnt`, `weixin_trade_amount`, `weixin_trade_cnt`, `zhifubao_trade_amount`, `zhifubao_trade_cnt`, `yinhangka_trade_cnt`, `yinhangka_trade_amount`, `mt_trade_amount`, `mt_trade_cnt`, `is_est`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027316
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_poi_trade_status_rpt_d` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027317
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mrk_customer_firstpage_d where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027318
              },
              {
                "serviceType": "yes",
                "sqlInfo": "insert into app_ml_rc_veri_predict_d values(?+)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027319
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u76ee\u6807\u8fbe\u6210\u60c5\u51b5\uff08\u533a\u57df\uff09 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u6797\u6599\u586b(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_rank `\u57ce\u5e02\u7b49\u7ea7` ,t?trade_cnt `\u4ea4\u6613\u7b14\u6570` ,t?total_trade_cnt_goal `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_poi_trade_cnt `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_trade_cnt_goal `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?)!=?,concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?),?) `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?pre_trade_cnt `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?pre_trade_cnt_goal `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?)!=?,concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?),?) `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?remain_trade_cnt `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?remain_trade_cnt_goal `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?)!=?,concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?),?) `\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?st_trade_cnt `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?st_trade_cnt_goal `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?)!=?,concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?),?) `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_est_trade_cnt `\u672c\u6708\u65b0\u589e\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?)!=?,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?)!=?,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?trade_amt `\u4ea4\u6613\u6d41\u6c34` from ( select dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_goal, if(? = ?,cd_region_new_poi_goal,region_new_poi_goal))),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_heavy_poi_goal, if(? = ?,cd_region_heavy_poi_goal,region_heavy_poi_goal))),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(if(? = ?,sab_region_total_trade_cnt_goal, if(? = ?,cd_region_total_trade_cnt_goal,region_total_trade_cnt_goal))),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_remain_trade_cnt_goal, if(? = ?,cd_region_remain_trade_cnt_goal,region_remain_trade_cnt_goal))),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_pre_trade_cnt_goal, if(? = ?,cd_region_pre_trade_cnt_goal,region_pre_trade_cnt_goal))),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_trade_cnt_goal, if(? = ?,cd_region_new_poi_trade_cnt_goal,region_new_poi_trade_cnt_goal))),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_est_trade_cnt_goal, if(? = ?,cd_region_est_trade_cnt_goal,region_est_trade_cnt_goal))),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) union all select dep_name ,state_name ,district_name ,region_name ,? as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(region_new_poi_goal),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(region_heavy_poi_goal),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(region_total_trade_cnt_goal),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(region_remain_trade_cnt_goal),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(region_pre_trade_cnt_goal),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(region_new_poi_trade_cnt_goal),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(region_est_trade_cnt_goal),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? where t?org_rank = ? order by if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027321
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_dw_employee_rept_auth` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027324
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_employee` character set utf?m? fields terminated by ? escaped by ? (`employee_id`, `employee_name`, `mis_name`, `gender`, `birthday`, `entry_date`, `left_date`, `position_id`, `position_begin_date`, `position_end_date`, `job_id`, `job_status`, `job_status_name`, `is_deleted`, `org_id`, `org_name`, `org_leader_id`, `superior_id`, `dep_id`, `dep_name`, `internal_email`, `mobile_phone_no`, `org_unit_id`, `effect_begin_date`, `is_enabled`, `effect_end_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027326
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_dw_bd_orgtree_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027332
              },
              {
                "serviceType": "yes",
                "sqlInfo": "drop table if exists `app_weixinmanjian_poiorder_d`",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027333
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bonus_poi_eff_sep_d` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027335
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `detail_device_deposit` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027336
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e00\u3001\u4e1a\u52a1\u8fdb\u5c55 \u8d1f\u8d23\u4eba:\u6731\u5c39\u534e \u67e5\u8be2\u4eba:\u6797\u7115\u57ce(?) select partition_date, count(distinct if(a.is_new_poi=?,a.poi_id,?)), count(distinct a.poi_id), count(distinct if(a.pos_days=? and a.coupon_days=?,a.poi_id,?)), count(distinct if(a.pos_days=? and a.coupon_days=?,a.poi_id,?)), count(distinct if(yinhangka_cnt? weixin_cnt? zhifubao_cnt<? and yinhangka_cnt? weixin_cnt? zhifubao_cnt>?,a.poi_id,?)), count(distinct if(a.pos_days=? and a.coupon_days=?,a.poi_id,?))\/count(a.poi_id)*?, count(distinct if(a.pos_days=? and a.coupon_days=?,a.poi_id,?))\/count(distinct a.poi_id)*?, count(distinct if(yinhangka_cnt? weixin_cnt? zhifubao_cnt<?,a.poi_id,?))\/count(a.poi_id)*?, sum(a.new_pos_cnt), sum(a.device_cnt), sum(a.only_coupon_device_cnt), sum(a.device_cnt)?sum(a.trade_device_cnt), sum(a.only_coupon_device_cnt)\/sum(a.device_cnt)*?, (sum(a.device_cnt)?sum(a.trade_device_cnt))\/sum(a.device_cnt)*? from zcdatamart.topic_trade_poi_d a where date_format(partition_date,?) >=? and date_format(partition_date,?)<=? and classid = ? group by partition_date order by partition_date",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027337
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u667a\u80fd\u652f\u4ed8_\u4e1a\u7ee9_bd\u660e\u7ec6 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u5f90\u9e4f\u98de(?) select if(? = ?, ?, if(? = ?, ?,if(? = ?, ?,if(? = ?,?,?)))) `\u4e1a\u52a1\u7c7b\u578b` ,if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) `\u65e5\u671f` , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(a.trade_cnt) `\u4ea4\u6613\u8ba2\u5355` ,sum(a.trade_amount) `\u4ea4\u6613\u989d` ,sum(a.poi_xz) `\u65b0\u589e\u95e8\u5e97\u6570` ,sum(a.pos_xz) `\u65b0\u589epos\u95e8\u5e97\u6570` ,sum(a.qrc_xz) `\u65b0\u589e\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,sum(a.sec_xz) `\u65b0\u589e\u79d2\u4ed8\u95e8\u5e97\u6570` ,sum(a.paybox_xz) `\u65b0\u589e\u76d2\u5b50\u95e8\u5e97\u6570` ,max(a.poi_hz) `\u5408\u4f5c\u95e8\u5e97\u6570` ,max(a.pos_hz) `\u5408\u4f5cpos\u95e8\u5e97\u6570` ,max(a.qrc_hz) `\u5408\u4f5c\u4e8c\u7ef4\u7801\u95e8\u5e97\u6570` ,max(a.sec_hz) `\u5408\u4f5c\u79d2\u4ed8\u95e8\u5e97\u6570` ,max(a.paybox_hz) `\u5408\u4f5c\u76d2\u5b50\u95e8\u5e97\u6570` from ( select d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ,sum(d.total_trade_cnt) trade_cnt ,sum(d.total_trade_amount) trade_amount ,max(pos_coop_poi_cnt) pos_hz ,sum(pos_newadd_poi_cnt) pos_xz ,max(qrc_coop_poi_cnt) qrc_hz ,sum(qrc_newadd_poi_cnt) qrc_xz ,max(secpay_coop_poi_cnt) sec_hz ,sum(secpay_newadd_poi_cnt) sec_xz ,max(paybox_coop_poi_cnt) paybox_hz ,sum(paybox_newadd_poi_cnt) paybox_xz ,max(coop_poi_cnt) poi_hz ,sum(newadd_poi_cnt) poi_xz ,sum(is_new_poi_cnt) is_new_cnt ,sum(is_poi_p_type_cnt) is_poi_p_type_cnt ,sum(is_new_poi_p_type_cnt) is_new_poi_p_type_cnt from ( select t?partition_date ,t?_id ,t?source ,concat(t?mployee_name,?,t?mis_name,if(t?job_status = ?, ?, ?)) `bd` ,t?mis_name ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?org_name `\u7ec4\u7ec7\u8282\u70b9` ,t?total_trade_cnt ,t?total_trade_amount ,t?org_id ,t?org_unit_id ,t?region_id ,t?istrict_id ,t?state_id ,t?pos_coop_poi_cnt ,t?pos_newadd_poi_cnt ,t?qrc_coop_poi_cnt ,t?qrc_newadd_poi_cnt ,t?secpay_coop_poi_cnt ,t?secpay_newadd_poi_cnt ,t?paybox_coop_poi_cnt ,t?paybox_newadd_poi_cnt ,t?oop_poi_cnt ,t?newadd_poi_cnt ,case when t?source = ? then t?is_new_poi_cnt else ? end as is_new_poi_cnt ,case when t?source = ? then t?is_poi_p_type_cnt else ? end as is_poi_p_type_cnt ,t?is_new_poi_p_type_cnt from zcdatamart.app_bonus_bd_perform_i_d t? where t?partition_date between ? and ? and if(?=?,t?source = ? , if(?=?,t?source = ? , if(?=?,t?source = ?,if(?=?,t?source = ?,t?source = ?)))) and if(?=?,t?job_status = ? , if(?=?,t?job_status <> ? ,?=?)) and if(? != ?, t?mis_name = ?, if(? > ?, ? in(t?org_id, t?org_unit_id, t?region_id, t?istrict_id, t?state_id), t?_id = ?)) ) d group by d.partition_date , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd ) a left join zcdatamart.dim_date t on a.partition_date = t.date group by if(? = ?, a.partition_date, if(? = ?,substr(a.partition_date,?,?), if(? = ?,concat(t.week_begin_date_key,?,t.week_end_date_key), ?))) , \u90e8\u95e8, \u5927\u533a, \u533a\u57df, \u57ce\u5e02, \u7ec4\u7ec7\u8282\u70b9, bd",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027338
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_poi_trade_status_rpt_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027339
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `device_gpv_detail` character set utf?m? fields terminated by ? escaped by ? (shop_id,type,device_id,device_sn,state,day_avg_gpv,target_gpv,not_reach_day_num,sync_day)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop_etl",
                "sqlId": 65027340
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e8c\u3001pos\u4ea4\u6613\u6c47\u603b \u8d1f\u8d23\u4eba:\u6731\u5c39\u534e \u67e5\u8be2\u4eba:\u6797\u7115\u57ce(?) select partition_date ?, ? as ?, sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt) ?, sum(weixin_cnt) ?, sum(zhifubao_cnt) ?, sum(yinhangka_cnt) ?, sum(pos_coupon_cnt) ?, ? as ?, round(sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount),?) ?, round(sum(weixin_amount),?) ?, round(sum(zhifubao_amount),?) ?, round(sum(yinhangka_amount),?) ?, round(sum(pos_coupon_amount),?) ?, ? as ?, round((sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount))\/(sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt)),?) ?, round(sum(weixin_amount)\/sum(weixin_cnt),?) ?, round(sum(zhifubao_amount)\/sum(zhifubao_cnt),?) ?, round(sum(yinhangka_amount)\/sum(yinhangka_cnt),?) ?, round(sum(pos_coupon_amount)\/sum(pos_coupon_cnt),?) ?, ? as ?, sum(weixin_cnt)\/(sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt))*? ?, sum(zhifubao_cnt)\/(sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt))*? ?, sum(yinhangka_cnt)\/(sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt))*? ?, sum(pos_coupon_cnt)\/(sum(weixin_cnt)?sum(zhifubao_cnt)?sum(yinhangka_cnt)?sum(pos_coupon_cnt))*? ?, ? as ?, sum(weixin_amount)\/(sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount))*? ?, sum(zhifubao_amount)\/(sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount))*? ?, sum(yinhangka_amount)\/(sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount))*? ?, sum(pos_coupon_amount)\/(sum(weixin_amount)?sum(zhifubao_amount)?sum(yinhangka_amount)?sum(pos_coupon_amount))*? ?, sum(pos_coupon_cnt)\/sum(poi_coupon_cnt)*? ? from zcdatamart.topic_trade_poi_d where date_format(partition_date,?) >=? and date_format(partition_date,?)<=? and poi_id not in(?+) and categoryname in(?+) group by partition_date order by partition_date",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027341
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_bd_dim_all` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027342
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_dw_device_mapping` character set utf?m? fields terminated by ? escaped by ? (`device_id`, `terminal_code`, `merchant_code`, `auth_code`, `hd_device_id`, `device_mode`, `device_sn`, `device_mfr_id`, `device_apply_id`, `apply_type`, `sd_ap_time`, `bank_account_id`, `acquirer_id`, `poi_id`, `poi_name`, `poi_city_id`, `poi_city_name`, `poi_org_unit_id`, `poi_org_unit_name`, `coop_id`, `ecom_account_id`, `merchant_id`, `bd_id`, `bd_mis_name`, `bd_name`, `bd_org_id`, `bd_org_name`, `bd_org_unit_id`, `bd_org_unit_name`, `bd_main_org_unit_id`, `bd_main_org_unit_name`, `bd_dep_id`, `bd_dep_name`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027344
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_monitior_poi_life_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027345
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:?\u6708_poi_\u6709\u6548_sab \u8d1f\u8d23\u4eba:\u674e\u590f\u96e8 \u67e5\u8be2\u4eba:\u9b4f\u94ed\u9633(?) select a.state_name `\u4e8b\u4e1a\u90e8` ,a.district_name `\u5927\u533a` ,a.region_name `\u533a\u57df` ,a.org_unit_name `\u57ce\u5e02` ,a.org_name `bd\u5c0f\u7ec4` ,a.bd `bd` ,a.main_poi_id `\u4e3b\u95e8\u5e97id` ,a.main_poi_name `\u4e3b\u95e8\u5e97\u540d\u79f0` ,a.brand_name `\u54c1\u724c\u540d\u79f0` ,a.first_trade_date `\u9996\u6b21\u4ea4\u6613\u65e5\u671f` ,a.avg_trade_cnt `\u95e8\u5e97\u8fdb\u5e97?\u5929\u5185\uff0c\u65e5\u5747\u8ba2\u5355(\u6bcf\u5355>=?\u5143) ` ,a.avg_trade_amount `\u95e8\u5e97\u8fdb\u5e97?\u5929\u5185\uff0c\u65e5\u5747gpv ` ,a.is_new `\u662f\u5426\u5f53\u6708\u65b0\u7b7e` ,a.pos_first_trade_date `pos\u9996\u6b21\u4ea4\u6613\u65e5\u671f` ,a.qrc_first_trade_date `\u4e8c\u7ef4\u7801\u9996\u6b21\u4ea4\u6613\u65e5\u671f` ,a.secpay_first_trade_date `\u79d2\u4ed8\u9996\u6b21\u4ea4\u6613\u65e5\u671f` ,a.paybox_first_trade_date `\u76d2\u5b50\u9996\u6b21\u4ea4\u6613\u65e5\u671f` ,a.qrc_avg_trade_cnt `\u4e8c\u7ef4\u7801\u8fdb\u5e97?\u5929\u5185\uff0c\u65e5\u5747\u8ba2\u5355 ` ,a.qrc_avg_trade_amount `\u4e8c\u7ef4\u7801\u8fdb\u5e97?\u5929\u5185\uff0c\u65e5\u5747gpv ` from ( select concat(c.employee_name, ?, c.mis_name, if(c.job_status = ?, ?, ?)) bd ,c.org_name ,c.org_unit_name ,c.region_name ,c.district_name ,c.state_name ,a.main_poi_id ,a.main_poi_name ,a.brand_name ,a.first_trade_date ,a.avg_trade_cnt ,a.avg_trade_amount ,a.poi_effective_time ,a.is_poi_eff ,a.is_new ,a.pos_first_trade_date ,a.qrc_first_trade_date ,a.secpay_first_trade_date ,a.paybox_first_trade_date ,a.qrc_avg_trade_cnt ,a.qrc_avg_trade_amount ,c.org_id, c.org_unit_id, c.area_id, c.region_id, c.district_id, c.state_id, c.dep_id, c.bd_id, c.org_leader_id from zcdatamart.app_bonus_poi_eff_sep_d a join zcdatamart.dim_dw_bd_orgtree_d c on a.qrc_first_bd = c.bd_id where if(? != ?, a.main_poi_id = ?, if(? != ?, c.mis_name = ?, if(? > ?, ? in(c.org_id, c.org_unit_id, c.area_id, c.region_id, c.district_id, c.state_id, c.dep_id), c.bd_id = ?) )) )a limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027347
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mrk_biz_firstpage_d where partition_date < date(date_add(now(),interval ? day))",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027350
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_bd_poi_bd_snapshot` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027351
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `topic_trade_poi_pos_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027352
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bd_trade_status_rpt_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027354
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select ? as id ,a.bd_id ,b.source ,concat(a.employee_name, ?, a.mis_name, if(a.job_status = ?, ?, ?)) as employee_name ,a.mis_name ,a.state_name ,a.district_name ,a.region_name ,a.org_unit_name ,a.org_name ,a.org_id ,a.org_unit_id ,a.area_id ,a.region_id ,a.district_id ,a.state_id ,a.dep_id ,a.org_leader_id ,b.total_trade_amount ,b.total_trade_cnt ,b.device_cnt ,b.online_poi_cnt ,b.new_poi_cnt ,b.sd_cnt ,b.sh_cnt ,b.eff_poi_cnt as yx_cnt ,b.trade_poi_cnt ,b.partition_date as date from zcdatamart.dim_dw_bd_orgtree_d a left join ( select t.partition_date ,t.bd_id ,t.source ,max(t.total_trade_amount) as total_trade_amount ,max(t.total_trade_cnt) as total_trade_cnt ,max(t.device_cnt) as device_cnt ,max(t.trade_poi_cnt) as trade_poi_cnt ,max(t.online_poi_cnt) as online_poi_cnt ,max(t.new_poi_cnt) as new_poi_cnt ,max(t.eff_poi_cnt) as eff_poi_cnt ,max(t.sd_cnt) as sd_cnt ,max(t.sh_cnt) as sh_cnt from ( select t?partition_date ,t?_id ,t?source ,t?total_trade_amount ,t?total_trade_cnt ,t?vice_cnt ,t?trade_poi_cnt ,t?online_poi_cnt ,? as new_poi_cnt ,? as eff_poi_cnt ,? as sd_cnt ,? as sh_cnt from zcdatamart.topic_bd_zcm_pay_info_d t? where t?partition_date= ? union all select c.date as partition_date ,c.bd_id ,d.source ,? as total_trade_amount ,? as total_trade_cnt ,? as device_cnt ,? as trade_poi_cnt ,? as online_poi_cnt ,count(if(d.first_trade_date = c.date, ?, ?)) new_poi_cnt ,count(if(d.effective_time= c.datekey, ?, ?)) eff_poi_cnt ,count(if(d.sd_date = c.date, ?, ?)) sd_cnt ,count(if(d.sh_date = c.date, ?, ?)) sh_cnt from ( select c.bd_id ,d.date ,d.datekey from zcdatamart.dim_dw_bd_orgtree_d c join zcdatamart.dim_date d where d.date = ? )c left join ( select poi_id ,bd_id ,source ,max(a.first_trade_date) as first_trade_date ,max(a.effective_time) as effective_time ,max(a.sd_date) as sd_date ,max(a.sh_date) as sh_date from ( select main_poi_id as poi_id ,pos_first_bd as bd_id ,? as source ,pos_first_trade_date as first_trade_date ,pos_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d union all select main_poi_id as poi_id ,qrc_first_bd as bd_id ,? as source ,qrc_first_trade_date as first_trade_date ,qrc_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d union all select main_poi_id as poi_id ,secpay_first_bd as bd_id ,? as source ,secpay_first_trade_date as first_trade_date ,secpay_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d union all select poi_id ,bd_id ,? as source ,min(first_trade_date) as first_trade_date ,min(effective_time) as effective_time ,? as sd_date ,? as sh_date from ( select main_poi_id as poi_id ,pos_first_bd as bd_id ,? as source ,pos_first_trade_date as first_trade_date ,pos_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d union all select main_poi_id as poi_id ,qrc_first_bd as bd_id ,? as source ,qrc_first_trade_date as first_trade_date ,qrc_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d union all select main_poi_id as poi_id ,secpay_first_bd as bd_id ,? as source ,secpay_first_trade_date as first_trade_date ,secpay_effective_time as effective_time ,? as sd_date ,? as sh_date from zcdatamart.app_bonus_poi_bd_d ) allbiz? group by poi_id ,bd_id union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,if(poi_first_app_apply_date is ? or poi_first_app_apply_date in(?+), poi_first_apply_date,poi_first_app_apply_date) as sd_date ,date(if(min_succ_aa_time in(?+),?,min_succ_aa_time)) as sh_date from zcdatamart.topic_flow_shop_stage union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,date(if(commit_time is ? or commit_time in(?+),?,commit_time)) as sd_date ,date(if(open_time is ? or open_time in(?+),?,open_time)) as sh_date from zcdatamart.dim_qrc_poi union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,date(if(commit_time in(?+),?,commit_time)) as sd_date ,date(greatest(open_time, if(last_install_status in(?+), last_install_time, ?))) as sh_date from zcdatamart.dim_coop_secpay_shop_check_ss union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,min(sd_date) as sd_date ,min(sd_date) as sh_date from ( select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,if(poi_first_app_apply_date is ? or poi_first_app_apply_date in(?+), poi_first_apply_date,poi_first_app_apply_date) as sd_date ,date(if(min_succ_aa_time in(?+),?,min_succ_aa_time)) as sh_date from zcdatamart.topic_flow_shop_stage union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,date(if(commit_time is ? or commit_time in(?+),?,commit_time)) as sd_date ,date(if(open_time is ? or open_time in(?+),?,open_time)) as sh_date from zcdatamart.dim_qrc_poi union all select poi_id ,bd_id ,? as source ,? as first_trade_date ,? as effective_time ,date(if(commit_time in(?+),?,commit_time)) as sd_date ,date(greatest(open_time, if(last_install_status in(?+), last_install_time, ?))) as sh_date from zcdatamart.dim_coop_secpay_shop_check_ss ) allbiz? group by poi_id ,bd_id ) a group by poi_id ,bd_id ,source ) d on c.bd_id = d.bd_id group by c.date, c.bd_id,d.source ) t group by t.partition_date,t.bd_id,t.source ) b on a.bd_id = b.bd_id",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027356
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_retention_analysis_rpt?_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027357
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `poi_list_label` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop_etl",
                "sqlId": 65027359
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_coop_poi_bd_orgtree_daily` character set utf?m? fields terminated by ? escaped by ? (`coop_id`, `coop_date`, `poi_id`, `poi_name`, `poi_date`, `bd_id`, `mis_name`, `employee_name`, `position_id`, `org_id`, `org_name`, `dep_id`, `dep_name`, `state_id`, `state_name`, `district_id`, `district_name`, `region_id`, `region_name`, `org_unit_id`, `org_unit_name`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027360
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_cooperation` character set utf?m? fields terminated by ? escaped by ? (`coop_id`, `city_id`, `contract_no`, `coop_name`, `coop_party`, `bd_id`, `sign_date`, `effective_date_type`, `effective_month`, `finish_date`, `exclusive_type`, `delay_till_year`, `final_finish_date`, `merchant_id`, `contact_email`, `contact_name`, `contact_mobile`, `create_user_id`, `create_time`, `last_modify_user_id`, `last_modify_time`, `status`, `note`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027361
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_poi_bd` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027363
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_coop_bd_efficiency_m` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027365
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_secpay_shop_check_ss` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `is_test_shop`, `close_status`, `brand_id`, `brand_name`, `org_id`, `org_name`, `city_id`, `city_name`, `type_id`, `type_name`, `class_id`, `class_name`, `category_id`, `category_name`, `is_dining`, `status`, `product_status`, `bd_id`, `commit_time`, `open_time`, `bind_time`, `first_trade_time`, `first_table_time`, `total_table_cnt`, `table_qrc_cnt`, `pos_name`, `pos_version`, `exe_init_time`, `exe_version`, `current_status`, `first_check_time`, `last_check_time`, `last_check_status`, `last_check_status_mean`, `check_duration`, `first_copy_time`, `last_copy_time`, `last_copy_status`, `last_copy_status_mean`, `copy_duration`, `first_adapt_time`, `last_adapt_time`, `last_adapt_status`, `last_adapt_status_mean`, `adapt_duration`, `first_install_time`, `last_install_time`, `last_install_status`, `last_install_status_mean`, `install_duration`, `active_duration`, `total_duration`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027366
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select z?qudao as id, z?qudao as name, z?state_name as id, z?state_name as name, z?istrict_name as id, z?istrict_name as name, z?region_name as id, z?region_name as name , z?org_unit_name as id, z?org_unit_name as name from (select z?p_id, z?p_name, z?state_id, case when z?qudao=? and z?state_id=? then z?state_name else ? end as state_name, z?istrict_id, case when z?qudao=? and z?state_id=? then z?istrict_name else ? end as district_name, z?region_id, case when z?qudao=? and z?state_id=? then z?region_name else ? end as region_name, z?org_unit_id, case when z?qudao=? and z?state_id=? then z?org_unit_name else ? end as org_unit_name, z?org_id_path, z?qudao from (select z?p_id, z?p_name, z?state_id, z?state_name, z?istrict_id, z?istrict_name, z?region_id, z?region_name , z?org_unit_id, z?org_unit_name , z?org_id_path, case when (z?p_id = ? or z?state_id in(?+)) and z?state_id not in(?+) then ? when (z?p_id = ? or z?state_id in(?+)) and z?state_id=? then ? when z?p_id in(?+) and (z?state_id in(?+) or (z?state_id = ? and z?istrict_id not in(?+))) then ? when z?p_id=? or z?state_id in(?+) then ? when z?state_id in(?+) then ? when z?p_id=? then ? else ? end as qudao from zcdatamart.dim_dw_bd_orgtree_d z? ) z?) z?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027367
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_hd_pos_monitor_d` where stat_date = ? or stat_date <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027374
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_hd_poi_monitor_d` character set utf?m? fields terminated by ? escaped by ? (stat_date,poi_id,poi_name,poi_first_trade_date,online_time,poi_city_id,poi_city_name,poi_?st_category_id,poi_?st_category_name,poi_?nd_category_id,poi_?nd_category_name,bd_id,bd_name,bd_mis_name,bd_job_status,bd_area_id,bd_area_name,bd_district_id,bd_district_name,bd_org_unit_id,bd_org_unit_name,bd_org_id,bd_org_name,bd_state_id,bd_state_name,bd_dep_id,bd_dep_name,bdm_id,bdm_name,cm_id,cm_name,credit_card_channel,dinner_type,best_head_tag,is_complete_deduct,is_licence_agreed,bind_hd_cnt,non_deduct_hd_cnt,should_deduct_amount,will_deduct_amount,is_open_recent_?ys,is_run_app_recent_?ys,avg_card_gpv_recent_?ys,avg_weixin_gpv_recent_?ys,avg_zhifubao_gpv_recent_?ys,avg_groupon_gmv_recent_?ys,avg_mopay_gmv_recent_?ys,avg_waimai_gmv_recent_?ys,is_card_deduct,is_pos_deduct,is_groupon_deduct,is_mopay_deduct,is_waimai_deduct,suggest_payment_channel,predict_payment_days)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027377
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select dt ,? as cycle ,source ,brand_id ,brand_name ,area ,poi_id ,poi_name ,is_dining ,categoryname ,city_name ,bd_id ,mis_name ,employee_name ,pos_cnt ,tatal_amount ,yinhangka_amount ,weixin_amount ,zhifubao_amount ,total_cnt ,yinhangka_cnt ,weixin_cnt ,zhifubao_cnt ,unit_price ,average_gpv ,average_cnt ,first_trade_date from app_ska_poi_detail_report_d where dt between ? and ? union all select dt ,? as cycle ,source ,brand_id ,brand_name ,area ,poi_id ,poi_name ,is_dining ,categoryname ,city_name ,bd_id ,mis_name ,employee_name ,pos_cnt ,tatal_amount ,yinhangka_amount ,weixin_amount ,zhifubao_amount ,total_cnt ,yinhangka_cnt ,weixin_cnt ,zhifubao_cnt ,unit_price ,average_gpv ,average_cnt ,first_trade_date from app_ska_poi_detail_report_w where dt between ? and ? union all select dt ,? as cycle ,source ,brand_id ,brand_name ,area ,poi_id ,poi_name ,is_dining ,categoryname ,city_name ,bd_id ,mis_name ,employee_name ,pos_cnt ,tatal_amount ,yinhangka_amount ,weixin_amount ,zhifubao_amount ,total_cnt ,yinhangka_cnt ,weixin_cnt ,zhifubao_cnt ,unit_price ,average_gpv ,average_cnt ,first_trade_date from app_ska_poi_detail_report_m where dt between ? and ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027379
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_secpay_poi_pull_trade_info` character set utf?m? fields terminated by ? escaped by ? (`date_type`, `poi_id`, `poi_name`, `first_trade_time`, `city_name`, `total_trade_cnt`, `total_trade_amount`, `succ_pull_rate`, `power_on_rate`, `succ_order_rate`, `total_pull_cnt`, `invalid_pull_cnt`, `as_front_cnt`, `offline_pull_cnt`, `actual_pull_cnt`, `succ_pull_cnt`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027429
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `topic_trade_poi_pos_d` where dt <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027430
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_coop_bd_efficiency_m` where month_begin_dt = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027432
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_secpay_poi_dish_ord_rpt_d` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `date_type`, `total_pull_cnt`, `succ_pull_cnt`, `invalid_pull_cnt`, `fail_pull_cnt`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027433
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `int_coop_secpay_shop_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027434
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select replace(replace(replace(`application_id`, ?, ?), ?, ?), ?, ?), `score`, `date` from `app_ml_rc_veri_predict_d` where date=?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027435
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bonus_poi_pay_d` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `bd_id`, `main_poi_id`, `main_poi_name`, `source`, `first_trade_date`, `total_trade_amount`, `total_tc_trade_amount`, `weixin_trade_amount`, `zhifubao_trade_amount`, `yinhangka_trade_amount`, `yinhangka_tc_trade_amount`, `mt_trade_amount`, `total_trade_cnt`, `weixin_trade_cnt`, `zhifubao_trade_cnt`, `yinhangka_trade_cnt`, `mt_trade_cnt`, `ge_?_cnt`, `ge_?_cnt`, `ge_?_cnt`, `total_trade_amount_all`, `total_ge_?_cnt`, `total_trade_amount_in?`, `trade_days`, `avg_trade_amount`, `avg_ge_?_cnt`, `avg_trade_amount_in?`, `online_days`, `is_est`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027436
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_trade_poi_coupon_daily` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `main_poi_id`, `poi_coupon_amount`, `poi_coupon_cnt`, `poi_coupon_profit`, `dt`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027437
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u4eba\u6548\uff08\u533a\u57df\uff09 \u8d1f\u8d23\u4eba:\u4efb\u58ee\u4f1f \u67e5\u8be2\u4eba:\u9b4f\u94ed\u9633(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_rank `\u57ce\u5e02\u7b49\u7ea7` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?new_poi_zh_avg,?) `\u7eaf\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?new_poi_dczg_avg,?) `\u7eaf\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?heavy_new_poi_zh_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?heavy_new_poi_dczg_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` from ( select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_goal, if(? = ?,cd_region_new_poi_goal,region_new_poi_goal))),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_heavy_poi_goal, if(? = ?,cd_region_heavy_poi_goal,region_heavy_poi_goal))),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) union all select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,? as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(region_new_poi_goal),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(region_heavy_poi_goal),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? where t?org_rank = ? order by round(t?new_poi_zh_avg,?) desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027439
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bd_deposit_daily` where dt = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027440
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `topic_market_bd_poi_daily` character set utf?m? fields terminated by ? escaped by ? (`bd_id`, `poi_id`, `bd_type`, `bd_name`, `bd_mis_name`, `org_id`, `org_name`, `org_unit_id`, `org_unit_name`, `region_id`, `region_name`, `district_id`, `district_name`, `state_id`, `state_name`, `dep_id`, `dep_name`, `job_status`, `coop_id`, `contract_begin_date`, `poi_name`, `poi_first_trade_date`, `yinhangka_deduction_rate`, `credit_deduction_rate`, `weixin_deduction_rate`, `zhifubao_deduction_rate`, `yinhangka_revenue`, `credit_revenue`, `weixin_revenue`, `zhifubao_revenue`, `yinhangka_commission`, `credit_commission`, `weixin_commission`, `zhifubao_commission`, `total_revenue`, `bonus_total_revenue`, `bonus_total_commission`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027441
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_qrc_shop_check` character set utf?m? fields terminated by ? escaped by ? (`poi_id`, `poi_name`, `feature_id`, `commit_time`, `open_time`, `bind_time`, `source`, `first_trade_time`, `settle_wx_deduction_rate`, `settle_ali_deduction_rate`, `bd_id`, `mis_name`, `employee_name`, `dep_id`, `dep_name`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027442
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u4eba\u6548\uff08\u57ce\u5e02\uff09 \u8d1f\u8d23\u4eba:\u4efb\u58ee\u4f1f \u67e5\u8be2\u4eba:\u9b4f\u94ed\u9633(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?new_poi_zh_avg,?) `\u7eaf\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?new_poi_dczg_avg,?) `\u7eaf\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?heavy_new_poi_zh_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?heavy_new_poi_dczg_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` from ( select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,org_unit_name ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(org_unit_new_poi_goal),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(org_unit_heavy_poi_goal),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.org_unit_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id <>? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,org_unit_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? order by round(t?new_poi_zh_avg,?) desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027443
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from app_mrk_biz_firstpage_d where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027444
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mkt_poi_task_chest_i_d` character set utf?m? fields terminated by ? escaped by ? (`task_record_id`, `poi_id`, `task_id`, `task_name`, `task_status`, `start_time`, `create_time`, `end_time`, `total_pay_count`, `wx_pay_count`, `pay_count`, `pay_amount`, `reward_status`, `reward_amount`, `channel`, `receive_time`, `seri_days`, `total_days`, `partition_date`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027445
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u4eba\u6548\uff08\u5927\u533a\uff09 \u8d1f\u8d23\u4eba:\u4efb\u58ee\u4f1f \u67e5\u8be2\u4eba:\u9b4f\u94ed\u9633(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?org_rank `\u57ce\u5e02\u7b49\u7ea7` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?new_poi_zh_avg,?) `\u7eaf\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?new_poi_dczg_avg,?) `\u7eaf\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?heavy_new_poi_zh_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?heavy_new_poi_dczg_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` from ( select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,case when a.scale in(?+) then ? else ? end as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(if(? = ?,sab_district_new_poi_goal, if(? = ?,cd_district_new_poi_goal,district_new_poi_goal))),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(if(? = ?,sab_district_heavy_poi_goal, if(? = ?,cd_district_heavy_poi_goal,district_heavy_poi_goal))),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.district_id = c.auth_org_id where a.partition_date between ? and ? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,case when a.scale in(?+) then ? else ? end ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) union all select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,? as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(district_new_poi_goal),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(district_heavy_poi_goal),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.district_id = c.auth_org_id where a.partition_date between ? and ? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? where t?org_rank = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027447
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `detail_coop_audit_record` character set utf?m? fields terminated by ? escaped by ? (`business_id`, `status`, `apply_create_time`, `apply_end_time`, `apply_user`, `ca_create_time`, `ca_start_time`, `ca_end_time`, `ca_user`, `ca_reject_reason`, `ama_create_time`, `ama_start_time`, `ama_end_time`, `ama_user`, `ama_reject_reason`, `aa_create_time`, `aa_end_time`, `aa_reject_reason`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027449
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_bd_zcm_pay_info_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027450
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `dim_coop_device_deposit` character set utf?m? fields terminated by ? escaped by ? (`device_id`, `distribute_type`, `deposit_time`, `strategy_type`, `minus_type`, `flow_pay_type`, `deposit_pay_type`, `sold_price`, `deposit_price`)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027453
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_poi_trade_status_rpt_d` where partition_date <= ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027454
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `app_bonus_monitior_poi_life_d` where partition_date = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027455
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `poi_list_label` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop_etl",
                "sqlId": 65027456
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select replace(replace(replace(`application_id`, ?, ?), ?, ?), ?, ?), `score`, replace(replace(replace(`level`, ?, ?), ?, ?), ?, ?), `date` from `app_ml_rc_lw_predict_d` where date=?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027457
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u4eba\u6548\uff08\u57ce\u5e02\uff09 \u8d1f\u8d23\u4eba:\u4efb\u58ee\u4f1f \u67e5\u8be2\u4eba:\u65b9\u5764(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_unit_name `\u57ce\u5e02` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?new_poi_zh_avg,?) `\u7eaf\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?new_poi_dczg_avg,?) `\u7eaf\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,round(t?new_poi_bd?_avg,?) `\u7eaf\u65b0_bd?\u4eba\u6548` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,round(t?heavy_new_poi_zh_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u7efc\u5408\u4eba\u6548` ,round(t?heavy_new_poi_dczg_avg,?) `\u91cd\u4ea7\u54c1\u65b0_\u5230\u9910\u8f6c\u5c97\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` ,round(t?heavy_new_poi_bd?_avg,?) `\u91cd\u4ea7\u54c1\u65b0_bd?\u4eba\u6548` from ( select case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,org_unit_name ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(org_unit_new_poi_goal),?) as new_poi_goal ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(org_unit_heavy_poi_goal),?) as heavy_poi_goal ,sum(new_poi_cnt)\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as new_poi_zh_avg ,sum(case when dczg_flag = ? then new_poi_cnt else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_dczg_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,sum(case when bd?_flag = ? then new_poi_cnt else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as new_poi_bd?_avg ,if(? = ?,sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt))\/(sum(a.onduty_days)\/count(distinct a.partition_date)) as heavy_new_poi_zh_avg ,sum(case when dczg_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when dczg_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_dczg_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,sum(case when bd?_flag = ? then if(? = ?,case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end,heavy_new_poi_cnt) else ? end)\/(sum(case when bd?_flag = ? then a.onduty_days else ? end)\/count(distinct a.partition_date)) as heavy_new_poi_bd?_avg ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_avg_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.org_unit_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id <>? group by case when dep_name=? then ? else dep_name end ,state_name ,district_name ,region_name ,org_unit_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? order by round(t?new_poi_zh_avg,?) desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027459
              },
              {
                "serviceType": "yes",
                "sqlInfo": "sqlid:? sqlname:\u4e1a\u7ee9\u76d1\u63a7?\u76ee\u6807\u8fbe\u6210\u60c5\u51b5\uff08\u533a\u57df\uff09 \u8d1f\u8d23\u4eba:\u674e\u5fb7\u987a \u67e5\u8be2\u4eba:\u65b9\u5764(?) select t?stat_dt `\u7edf\u8ba1\u65e5\u671f` ,t?state_name `\u90e8\u95e8` ,t?istrict_name `\u5927\u533a` ,t?region_name `\u533a\u57df` ,t?org_rank `\u57ce\u5e02\u7b49\u7ea7` ,t?trade_cnt `\u4ea4\u6613\u7b14\u6570` ,t?total_trade_cnt_goal `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) `\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_poi_trade_cnt `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_trade_cnt_goal `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?)!=?,concat(round(t?new_poi_trade_cnt\/t?new_poi_trade_cnt_goal*?,?),?),?) `\u672c\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?pre_trade_cnt `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?pre_trade_cnt_goal `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?)!=?,concat(round(t?pre_trade_cnt\/t?pre_trade_cnt_goal*?,?),?),?) `\u4e0a\u6708\u65b0\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?remain_trade_cnt `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?remain_trade_cnt_goal `\u5386\u53f2\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?)!=?,concat(round(t?remain_trade_cnt\/t?remain_trade_cnt_goal*?,?),?),?) `\u5b58\u91cf\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?st_trade_cnt `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?st_trade_cnt_goal `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807` ,if(concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?)!=?,concat(round(t?st_trade_cnt\/t?st_trade_cnt_goal*?,?),?),?) `\u5230\u9910\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?new_est_trade_cnt `\u672c\u6708\u65b0\u589e\u9057\u4ea7\u95e8\u5e97\u4ea4\u6613\u7b14\u6570` ,t?new_poi_cnt `\u7eaf\u65b0\u95e8\u5e97\u6570` ,t?new_poi_goal `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?)!=?,concat(round(t?new_poi_cnt\/t?new_poi_goal*?,?),?),?) `\u7eaf\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?heavy_new_poi_cnt `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570` ,t?heavy_poi_goal `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807` ,if(concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?)!=?,concat(round(t?heavy_new_poi_cnt\/t?heavy_poi_goal*?,?),?),?) `\u91cd\u4ea7\u54c1\u65b0\u95e8\u5e97\u6570?\u76ee\u6807\u8fbe\u6210\u7387` ,t?trade_amt `\u4ea4\u6613\u6d41\u6c34` from ( select dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_goal, if(? = ?,cd_region_new_poi_goal,region_new_poi_goal))),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(if(? = ?,sab_region_heavy_poi_goal, if(? = ?,cd_region_heavy_poi_goal,region_heavy_poi_goal))),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(if(? = ?,sab_region_total_trade_cnt_goal, if(? = ?,cd_region_total_trade_cnt_goal,region_total_trade_cnt_goal))),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_remain_trade_cnt_goal, if(? = ?,cd_region_remain_trade_cnt_goal,region_remain_trade_cnt_goal))),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_pre_trade_cnt_goal, if(? = ?,cd_region_pre_trade_cnt_goal,region_pre_trade_cnt_goal))),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_new_poi_trade_cnt_goal, if(? = ?,cd_region_new_poi_trade_cnt_goal,region_new_poi_trade_cnt_goal))),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(if(? = ?,sab_region_est_trade_cnt_goal, if(? = ?,cd_region_est_trade_cnt_goal,region_est_trade_cnt_goal))),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,case when a.scale in(?+) then ? else ? end ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) union all select dep_name ,state_name ,district_name ,region_name ,? as org_rank ,sum(new_poi_cnt) as new_poi_cnt ,if(? = ?,max(region_new_poi_goal),?) as new_poi_goal ,if(? = ?, sum(case when a.partition_date = ? then heavy_new_poi_cnt_m else ? end),sum(heavy_new_poi_cnt)) as heavy_new_poi_cnt ,if(? = ?,max(region_heavy_poi_goal),?) as heavy_poi_goal ,sum(trade_cnt) as trade_cnt ,if(? = ?,max(region_total_trade_cnt_goal),?) as total_trade_cnt_goal ,sum(remain_trade_cnt) as remain_trade_cnt ,if(? = ?,max(region_remain_trade_cnt_goal),?) as remain_trade_cnt_goal ,sum(pre_trade_cnt) as pre_trade_cnt ,if(? = ?,max(region_pre_trade_cnt_goal),?) as pre_trade_cnt_goal ,sum(new_poi_trade_cnt) as new_poi_trade_cnt ,if(? = ?,max(region_new_poi_trade_cnt_goal),?) as new_poi_trade_cnt_goal ,sum(est_trade_cnt) as est_trade_cnt ,if(? = ?,max(region_est_trade_cnt_goal),?) as est_trade_cnt_goal ,sum(new_est_trade_cnt) as new_est_trade_cnt ,sum(trade_amt) as trade_amt ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) as stat_dt from zcdatamart.app_bd_bonus_monitor_target_d a left join zcdatamart.dim_date t on a.partition_date = t.date inner join (select distinct auth_org_id from zcdatamart.dim_dw_employee_rept_auth t where employee_id = ?) c on a.region_id = c.auth_org_id where a.partition_date between ? and ? and a.district_id not in(?+) group by dep_name ,state_name ,district_name ,region_name ,if(? = ?,a.partition_date, if(? = ?,substr(a.partition_date,?,?), ?)) ) t? where t?org_rank = ? order by if(concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?)!=?,concat(round(t?trade_cnt\/t?total_trade_cnt_goal*?,?),?),?) desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcdatamart",
                "sqlId": 65027461
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `app_mrk_customer_firstpage_d` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_exchange",
                "sqlId": 65027462
              }
            ]
          },
          "zcmcrmetl": {
            "businessGroupName": "\u9500\u552e\u7ba1\u7406\u7ec4",
            "serviceGroupOwner": "mada03",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "zcmcrmetl",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct poi_id, poi_name from int_zcm_poi_meta where poi_name like concat(?,?) limit ?",
                "queryCount": 32,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027197
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `int_zcm_poi_kpi` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 29,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027199
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `int_zcm_poi_meta` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 10,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027209
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct poi_id, poi_name from int_zcm_poi_meta where poi_name like concat(?,?) limit ?",
                "queryCount": 8,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027214
              },
              {
                "serviceType": "yes",
                "sqlInfo": "delete from `int_zcm_poi_meta` where partition_date=?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027323
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `int_zcm_bd_kpi` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027327
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `etl_poi_trade_?` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_cogman_etl",
                "sqlId": 65027330
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `etl_bd` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_cogman_etl",
                "sqlId": 65027331
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `etl_poi_eff_pro_?` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_cogman_etl",
                "sqlId": 65027334
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `int_zcm_pos_kpi` character set utf?m? fields terminated by ? escaped by ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_crm_etl",
                "sqlId": 65027343
              }
            ]
          },
          "poszcmcoop": {
            "businessGroupName": "\u4f9b\u5e94\u94fe\u7ec4",
            "serviceGroupOwner": "sunhao03",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "poszcmcoop",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select id, device_mfr, device_sn, device_mode, device_type, acquirer_id, batch_no, token, device_status, trade_status, device_location, from_loc, to_loc, flow_status, normal, installed, sign_time, create_time, modify_time, biz, from_biz, to_biz, owner_id, owner,union_pay_sn, status_detail,func_type,reusable, silent_period,imsi from device where flow_status = ? and installed = ? and device_sn like concat(?,?) and biz = ? and device_mode in(?+) limit ?",
                "queryCount": 23,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027200
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, shop_id,bd,business_license, business_license_code,business_license_number,location_id, address, audit_status, reject_reason, create_time,update_time, type from oasis where update_time between ? and ? order by id",
                "queryCount": 11,
                "slowType": "0.5S",
                "dbName": "zcm_coop",
                "sqlId": 65027207
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, device_mfr, device_sn, device_mode, device_type, acquirer_id, batch_no, token, device_status, trade_status, device_location, from_loc, to_loc, flow_status, normal, installed, sign_time, create_time, modify_time, biz, from_biz, to_biz, owner_id, owner,union_pay_sn, status_detail,func_type,reusable, silent_period,imsi from device where flow_status = ? and installed = ? and device_sn like concat(?,?) and biz = ? and device_mode in(?+) limit ?",
                "queryCount": 9,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027212
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, apply_id, shop_id, shop_name, biz, location, bd_id, bd, device_type, device_version, apply_num, client_id, audit_status, create_time, update_time, deliver_status from undelivered where deliver_status = ? group by biz, location",
                "queryCount": 6,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027217
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(?) from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.state in(?+) and r.req_type in(?+)",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027243
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select r.id as id, r.request_business_id as request_business_id, r.req_type as req_type, r.unq_id as unq_id, r.unq_type as unq_type, r.req_user_id as req_user_id, r.req_user_name as req_user_name, r.req_user_login as req_user_login, r.state as state, date_format(r.create_time, ?) as create_time, r.update_time as update_time from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.state in(?+) and r.req_type in(?+) order by id limit ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027244
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select r.id as id, r.request_business_id as request_business_id, r.req_type as req_type, r.unq_id as unq_id, r.unq_type as unq_type, r.req_user_id as req_user_id, r.req_user_name as req_user_name, r.req_user_login as req_user_login, r.state as state, date_format(r.create_time, ?) as create_time, r.update_time as update_time from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.create_time <= ? and r.state in(?+) and r.req_type in(?+) order by id limit ?",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027245
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(?) from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.create_time <= ? and r.state in(?+) and r.req_type in(?+)",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027246
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, request_business_id, req_type, unq_id, unq_type, req_user_id, req_user_name, req_user_login, state, date_format(create_time, ?) as create_time, update_time from task_request where ? = ? and create_time >= ? and req_type = ? and state in(?+) order by id limit ?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027274
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, apply_id, shop_id, shop_name, biz, location, bd_id, bd, device_type, device_version, apply_num, client_id, audit_status, create_time, update_time, deliver_status from undelivered where deliver_status = ? group by biz, location",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027276
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select * from device_log where device_id = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027426
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id,biz_user_id,register_status,register_type,acquirer_id,bank_account_id,settle_period,deduction_type, deduction_rate,capping_money,merchant_no,customer_no,create_time,update_time from acquirer_register where customer_no = ? and register_type in(?+)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop",
                "sqlId": 65027427
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, request_business_id, req_type, unq_id, unq_type, req_user_id, req_user_name, req_user_login, state, date_format(create_time, ?) as create_time, update_time from task_request where ? = ? and create_time >= ? and state in(?+) order by id limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027428
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select r.id as id, r.request_business_id as request_business_id, r.req_type as req_type, r.unq_id as unq_id, r.unq_type as unq_type, r.req_user_id as req_user_id, r.req_user_name as req_user_name, r.req_user_login as req_user_login, r.state as state, date_format(r.create_time, ?) as create_time, r.update_time as update_time from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.state in(?+) and r.req_type in(?+) order by id limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027431
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, shop_id, coop_id, apply_num,deposit_num,sold_num,free_num, applier_id,sync_photo, status, create_time, update_time,fail_reason,process_id,audit_result,reject_reason,minus_type,deposit_return_rule,merchant_id, bank_account_id, deposit_pay_type,sold_price,deposit_price,apply_type,last_apply_id from device_apply where sync_photo=? and status=?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop",
                "sqlId": 65027438
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select apply_id, client_id from undelivered where biz = ? and device_type = ? group by apply_id, client_id order by deliver_status, audit_status desc, create_time limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "pos_manage",
                "sqlId": 65027446
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select r.id as id, r.request_business_id as request_business_id, r.req_type as req_type, r.unq_id as unq_id, r.unq_type as unq_type, r.req_user_id as req_user_id, r.req_user_name as req_user_name, r.req_user_login as req_user_login, r.state as state, date_format(r.create_time, ?) as create_time, r.update_time as update_time from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.create_time <= ? and r.state in(?+) and r.req_type in(?+) order by id limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027448
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(?) from task_request r, pos_request_detail d where ? = ? and r.id = d.req_id and d.enabled = ? and d.info_key = ? and d.info_value = ? and r.create_time >= ? and r.create_time <= ? and r.state in(?+) and r.req_type in(?+)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027451
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, request_business_id, req_type, unq_id, unq_type, req_user_id, req_user_name, req_user_login, state, date_format(create_time, ?) as create_time, update_time from task_request where ? = ? and create_time >= ? and req_type = ? and state in(?+) order by id limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_hammurabi",
                "sqlId": 65027452
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(distinct biz_user_id) from product where product_type = ? and product_status = ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "zcm_coop",
                "sqlId": 65027460
              }
            ]
          },
          "paycloudcksettle": {
            "businessGroupName": "\u4ea4\u6613\u7814\u53d1\u7ec4",
            "serviceGroupOwner": "zhaodaojun",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "paycloudcksettle",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select trade_date, bank, trade_source , source_merchant_id, count(id) as tradenum, ifnull(sum(case trade_type when ? then trade_amount else ? end), ?) trade_amount, ifnull(sum(case trade_type when ? then ? else trade_amount end), ?) refund_amount, ifnull(sum(case trade_type when ? then third_fee else third_fee * ? end), ?) as trade_fee from trade_outer_bill_? where trade_date = ? and bank = ? and trade_source = ? group by trade_date,bank,trade_source",
                "queryCount": 60,
                "slowType": "0.5S",
                "dbName": "cloudcksettle",
                "sqlId": 65027192
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id, merchant_id, channel_code, sub_app_id, subscribe_app_id, ctime, utime from merchant_report_sub_app where ( merchant_id = ? and channel_code = ? )",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "cloudcksettle",
                "sqlId": 65027307
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select table_schema,table_name,column_name,column_type,is_nullable,column_default,character_set_name,collation_name,column_comment from information_schema.columns where table_schema not in(?+)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "mysql",
                "sqlId": 65027311
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select table_schema,table_name,table_type,engine,table_rows,data_length,index_length,create_time,table_collation,table_comment, data_free from information_schema.tables where table_schema not in(?+)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "mysql",
                "sqlId": 65027312
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select * from trade_amiss_bill where check_status = ? order by id desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "cloudcksettle",
                "sqlId": 65027369
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select * from trade_amiss_bill where check_status = ? and trade_source = ? order by id desc limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "cloudcksettle",
                "sqlId": 65027370
              }
            ]
          },
          "posmarketing": {
            "businessGroupName": "\u8425\u9500\u7ec4",
            "serviceGroupOwner": "shiwentao",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "posmarketing",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from promotion_user_coupon as user_coupon left join promotion_activity as activity on user_coupon.activity_id=activity.id where user_coupon.create_time between ? and ? and activity.type=?",
                "queryCount": 6,
                "slowType": "0.5S",
                "dbName": "posmarketing",
                "sqlId": 65027215
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from promotion_user_coupon as user_coupon left join promotion_activity as activity on user_coupon.activity_id=activity.id where user_coupon.create_time between ? and ? and activity.type=?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "posmarketing",
                "sqlId": 65027249
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from promotion_user_coupon as user_coupon left join promotion_activity as activity on user_coupon.activity_id=activity.id where user_coupon.consume_time between ? and ? and activity.type=?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "posmarketing",
                "sqlId": 65027251
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from promotion_user_coupon as user_coupon left join promotion_activity as activity on user_coupon.activity_id=activity.id where user_coupon.create_time between ? and ? and activity.type=?",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "posmarketing",
                "sqlId": 65027252
              }
            ]
          },
          "poscommon": {
            "businessGroupName": "\u5ba2\u6237\u7aef\u7ec4",
            "serviceGroupOwner": "yanfei05",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "poscommon",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, count(*) as trans_num, sum(case when (error_code in(?+)) then ? else ? end) as reversal_num, sum(case when (is_successful = ?) then ? else ? end) as succeed_num, sum(case when (is_successful = ?) then ? else ? end) as fail_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by stat_date order by stat_date",
                "queryCount": 5,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027222
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select concat(error_code, ?, error_msg) as error_msg_new, count(concat(error_code, ?, error_msg)) as `count` from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by error_msg_new order by `count` desc, error_msg_new",
                "queryCount": 4,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027226
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, count(pan_input_type) as `count` from holygrail.lx_trans_data_v? where pan_input_type in(?+) and stat_date >= ? and stat_date < ? and version_name in(?+) group by pan_input_type order by `count` desc",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027235
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select ? as result, count(id) as num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and is_successful = ? and trans_name not in(?+) and error_code not in(?+) \/*repeat union all*\/ union all select ? as result, count(id) as num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and error_code in(?+)",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027236
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, version_name, count(distinct(sn)) as num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? group by stat_date, version_name",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027238
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select trans_name, count(trans_name) as ? from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) group by trans_name order by count(trans_name) desc",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027240
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select concat(error_code, ?, error_msg) as error_msg_new, count(concat(error_code, ?, error_msg)) as `count` from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and !(error_code = ? and error_msg = ?) and (error_code != ?) and (char_length(error_code) = ? or error_code > ?) group by error_msg_new order by `count` desc, error_msg_new",
                "queryCount": 3,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027241
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, avg(duration) as duration from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and error_code = ? and trans_name = ? and pan_input_type = ? and trans_name not in(?+) order by duration desc",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027263
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, count(*) as trans_num, sum(amount?) \/ (?) as total_amount from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and is_successful = ? and version_name in(?+) and trans_name in(?+) group by stat_date order by stat_date",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027264
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, count(*) as trans_num, sum(case when (reversal_reason_code = ?) then ? else ? end) as ic_num from holygrail.lx_trans_data_v? where stat_date >= ? and version_name in(?+) and trans_name not in(?+) group by stat_date order by stat_date",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027266
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, count(*) as trans_num, sum(case when (reversal_error_code = ?) then ? else ? end) as ic_num from holygrail.lx_trans_data_v? where stat_date >= ? and version_name in(?+) and trans_name not in(?+) group by stat_date order by stat_date",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027267
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, count(*) as trans_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and error_code = ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by pan_input_type order by trans_num desc",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027269
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select error_code, count(*) as trans_num, sum(case when (error_code = ?) then ? else ? end) as success_num, sum(case when (error_code = ?) then ? else ? end) as apdu_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name = ? group by error_code order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027388
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select stat_date, count(*) as trans_num, sum(case when (reversal_reason_code = ?) then ? else ? end) as ic_num from holygrail.lx_trans_data_v? where stat_date >= ? and version_name in(?+) and pan_input_type = ? and trans_name not in(?+) group by stat_date order by stat_date",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027393
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, avg(duration) as duration from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and error_code = ? and trans_name not in(?+) group by pan_input_type order by duration desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027396
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, avg(duration) as duration from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) group by pan_input_type order by duration desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027400
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, avg(duration) as duration from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and error_code = ? and trans_name = ? and trans_name not in(?+) group by pan_input_type order by duration desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027405
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, count(*) as trans_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and error_code = ? and version_name in(?+) and trans_name = ? and error_code not in(?+) group by pan_input_type order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027407
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select pan_input_type, count(*) as trans_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) group by pan_input_type order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027408
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select sn, count(*) as trans_num, sum(case when (error_code = ?) then ? else ? end) as apdu_error_num, sum(case when (error_code = ?) then ? else ? end) as downgrade_error_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by sn order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027409
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select merchant_id, sn, count(sn) as total_num, sum(case when is_successful = ? then ? else ? end) as success_num, sum(case when is_successful = ? and trans_name in(?+) then amount else ? end) \/ ? as amount from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by merchant_id, sn order by total_num desc, merchant_id, sn",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027413
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) as trans_num, sum(case when (pan_input_type = ?) then ? else ? end) as rf_num, sum(case when (pan_input_type = ?) then ? else ? end) as ic_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and error_code = ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by sn order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027414
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select sn, count(*) as trans_num, sum(case when (pan_input_type = ?) then ? else ? end) as mag_num, sum(case when (pan_input_type = ?) then ? else ? end) as rf_num, sum(case when (pan_input_type = ?) then ? else ? end) as ic_num from holygrail.lx_trans_data_v? where stat_date >= ? and stat_date < ? and error_code = ? and version_name in(?+) and trans_name not in(?+) and error_code not in(?+) group by sn order by trans_num desc",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027418
              },
              {
                "serviceType": "yes",
                "sqlInfo": "load data local infile ? replace into table `lx_trans_data_v?` character set utf?m? fields terminated by ? escaped by ? (event_identifier,stat_date,stat_time,trans_name,is_successful,merchant_id,terminal_id,device_model,sn,duration,batch_no,trace_no,pan,pan_input_type,amount,card_association,is_pin_free_trans,is_retry_trans,error_code,error_msg,reversal_error_code,reversal_error_msg,reversal_reason_code,reversal_reason_msg,print_type,print_result,print_error_code,print_error_msg,lng,lat,geo_province,geo_city,geo_district,version_name,ip,network,wifi_status,operator)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "holygrail",
                "sqlId": 65027458
              }
            ]
          },
          "settlebill": {
            "businessGroupName": "\u7ed3\u7b97\u7ec4",
            "serviceGroupOwner": "yinfuyao",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "settlebill",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "rename table `settlebill`.`settle_flow?` to `settlebill`.`_settle_flow?_del`, `settlebill`.`_settle_flow?_gho` to `settlebill`.`settle_flow?`",
                "queryCount": 226,
                "slowType": "0.5S",
                "dbName": "settlebill",
                "sqlId": 65027186
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select * from settle_flow? where terminal_id > ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "settlebill",
                "sqlId": 65027397
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select * from `settle_flow?` order by `terminal_id` limit ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "settlebill",
                "sqlId": 65027399
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select table_schema, table_name from information_schema.tables where table_schema not in(?+) and table_name not in (select table_name from information_schema.table_constraints where constraint_type=? or constraint_type=?)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "settlebill",
                "sqlId": 65027425
              }
            ]
          },
          "posarchive": {
            "businessGroupName": "\u4ea4\u6613\u7814\u53d1\u7ec4",
            "serviceGroupOwner": "liuzhao02",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "posarchive",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select `id`, `status`, `device_id`, `merchant_id`, `currency`, `total_fee`, `discount`, `activity_id`, replace(replace(replace(`body`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`detail`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`batchno`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`traceno`, ?, ?), ?, ?), ?, ?), `expire`, `attr`, replace(replace(replace(`attach`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`ip`, ?, ?), ?, ?), ?, ?), `ordertime`, `cutday`, `paytime`, `modtime`, `payinfo_id`, `paytype`, `big_type`, replace(replace(replace(`transaction_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`tradeno`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`reason`, ?, ?), ?, ?), ?, ?), `origin`, replace(replace(replace(`out_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`promotion`, ?, ?), ?, ?), ?, ?), `account_type`, replace(replace(replace(`merchant_appid`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`user_no`, ?, ?), ?, ?), ?, ?), `terminal_id`, replace(replace(replace(`ext?`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`ext?`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`trade_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`business_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`trade_source`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`product_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`custom_product_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`merchant_name`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`table_no`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`goods_name`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`goods_detail`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`business_command`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`notify_url`, ?, ?), ?, ?), ?, ?), `expire_time`, replace(replace(replace(`currency_type`, ?, ?), ?, ?), ?, ?), `business_amount`, `business_discount_amount`, `trade_amount`, `trade_discount_amount`, `receipt_amount`, `refund_amount`, `trade_status`, `ctime`, `utime`, replace(replace(replace(`remark`, ?, ?), ?, ?), ?, ?), `pay_success_time` from `orderinfo_?`",
                "queryCount": 100,
                "slowType": "0.5S",
                "dbName": "pos",
                "sqlId": 65027189
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select `id`, `status`, `device_id`, `merchant_id`, `orderid`, `paytype`, replace(replace(replace(`traceno`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`batchno`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`outno`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`tradeno`, ?, ?), ?, ?), ?, ?), `currency`, replace(replace(replace(`finance_no`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`pay_data`, ?, ?), ?, ?), ?, ?), `total_fee`, `discount`, `accountid`, `paymethod`, `addtime`, `cutday`, `paytime`, `modtime`, replace(replace(replace(`pay_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`trade_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`acquire_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`bank_order_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`terminal_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`terminal_sn`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`terminal_mode`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`ip`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`longitude`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`latitude`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`trade_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`trade_channel`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`service_provider`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`pay_service`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`pay_account_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`pay_account`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`sub_app_id`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`card_source`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`card_organ`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`card_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`card_medium`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`swipe_card_method`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`order_success_type`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`notify_url`, ?, ?), ?, ?), ?, ?), replace(replace(replace(`operator`, ?, ?), ?, ?), ?, ?), `pay_amount`, `pay_status`, `finish_time`, `ctime`, `utime` from `payinfo_?`",
                "queryCount": 100,
                "slowType": "0.5S",
                "dbName": "pos",
                "sqlId": 65027190
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from orderinfo_? where ordertime between ? and ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "pos",
                "sqlId": 65027322
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(*) from payinfo_? where addtime between ? and ?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "pos",
                "sqlId": 65027328
              }
            ]
          },
          "possettle": {
            "businessGroupName": "\u7ed3\u7b97\u7ec4",
            "serviceGroupOwner": "duanhexin",
            "projectName": "\u62db\u8d22\u732b",
            "createDate": "2018-03-15",
            "serviceGroupName": "possettle",
            "projectOwner": "linchangqi",
            "sqlList": [
              {
                "serviceType": "yes",
                "sqlInfo": "select count(?) as amount from payment_unit where settlement_date=? and payment_type=? and (status=? or payment_date>?)",
                "queryCount": 51,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027194
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select id as id, event_type as eventtype, pay_type as paytype, device_id as deviceid, poi_id as poiid, trade_no as tradeno, pay_trade_no as pay_trade_no, trade_amount as tradeamount, event_time as eventtime, cut_day as cutday, refund_no as refundno from voucher_? where poi_id = ? and pay_trade_no = ?",
                "queryCount": 8,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027213
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select l.settle_unit_id,l.unit_type,max(l.settlement_date) as settlement_date from payment_unit l left join (select settle_unit_id,unit_type from payment_unit where settlement_date=? and status=? and payment_type=?) r on r.settle_unit_id=l.settle_unit_id where l.settlement_date < ? and l.status=? and l.payment_type=? and r.settle_unit_id is not ? group by l.settle_unit_id",
                "queryCount": 2,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027248
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct shop_id from device",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027279
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select count(?) as amount from payment_unit where settlement_date=? and payment_type=? and (status=? or payment_date>?)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027284
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct d.shop_id from deposit_rule d where deposit_type in(?+) and d.deduct_type=? and (deduct_status<>? and return_status<>?)",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027289
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select table_schema as dbname,convert((sum(data_length?index_length?data_free)),char(?)) as dbsize from information_schema.tables where table_schema in(?+) group by table_schema",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027291
              },
              {
                "serviceType": "yes",
                "sqlInfo": "select distinct (shop_id) from white_box_deposit_info where deposit_type=? and return_status=?",
                "queryCount": 1,
                "slowType": "0.5S",
                "dbName": "possettle",
                "sqlId": 65027293
              }
            ]
          }
        }
      }
    },
    "totalBgSlowQueryInfo": [
      {
        "queryCount": 412962,
        "typeCount": 3186,
        "bgName": "\u9152\u5e97\u65c5\u6e38\u4e8b\u4e1a\u7fa4"
      },
      {
        "queryCount": 256356,
        "typeCount": 1687,
        "bgName": "\u5916\u5356\u914d\u9001"
      },
      {
        "queryCount": 191242,
        "typeCount": 969,
        "bgName": "\u5ba2\u670d\u5e73\u53f0"
      },
      {
        "queryCount": 2344536,
        "typeCount": 867,
        "bgName": "\u6280\u672f\u5de5\u7a0b\u53ca\u57fa\u7840\u6570\u636e\u5e73\u53f0"
      },
      {
        "queryCount": 83376,
        "typeCount": 839,
        "bgName": "\u5230\u5e97\u9910\u996e"
      },
      {
        "queryCount": 706312,
        "typeCount": 772,
        "bgName": "\u7f8e\u56e2\u5e73\u53f0"
      },
      {
        "queryCount": 201042,
        "typeCount": 515,
        "bgName": "\u732b\u773c\u7535\u5f71"
      },
      {
        "queryCount": 259719,
        "typeCount": 498,
        "bgName": "\u4f01\u4e1a\u5e73\u53f0"
      },
      {
        "queryCount": 115825,
        "typeCount": 337,
        "bgName": "\u5e7f\u544a\u5e73\u53f0"
      },
      {
        "queryCount": 52530,
        "typeCount": 300,
        "bgName": "\u9910\u996e\u751f\u6001"
      }
    ]
  },
  "result": 0,
  "token": {
    "name": "meituan_dba_token",
    "value": "b3aa1de3d1ae10978548fea3e1733ff2"
  }
}